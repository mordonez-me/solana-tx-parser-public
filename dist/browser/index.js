import{utils as t,BN as e,BorshInstructionCoder as n}from"@coral-xyz/anchor";import{PublicKey as r,TransactionInstruction as o,SystemProgram as i,VersionedMessage as s,Transaction as a,VersionedTransaction as u,SystemInstruction as c}from"@solana/web3.js";for(var f={},h={byteLength:function(t){var e=m(t),n=e[0],r=e[1];return 3*(n+r)/4-r},toByteArray:function(t){var e,n,r=m(t),o=r[0],i=r[1],s=new p(function(t,e,n){return 3*(e+n)/4-n}(0,o,i)),a=0,u=i>0?o-4:o;for(n=0;n<u;n+=4)e=l[t.charCodeAt(n)]<<18|l[t.charCodeAt(n+1)]<<12|l[t.charCodeAt(n+2)]<<6|l[t.charCodeAt(n+3)],s[a++]=e>>16&255,s[a++]=e>>8&255,s[a++]=255&e;2===i&&(e=l[t.charCodeAt(n)]<<2|l[t.charCodeAt(n+1)]>>4,s[a++]=255&e);1===i&&(e=l[t.charCodeAt(n)]<<10|l[t.charCodeAt(n+1)]<<4|l[t.charCodeAt(n+2)]>>2,s[a++]=e>>8&255,s[a++]=255&e);return s},fromByteArray:function(t){for(var e,n=t.length,r=n%3,o=[],i=16383,s=0,a=n-r;s<a;s+=i)o.push(w(t,s,s+i>a?a:s+i));1===r?(e=t[n-1],o.push(d[e>>2]+d[e<<4&63]+"==")):2===r&&(e=(t[n-2]<<8)+t[n-1],o.push(d[e>>10]+d[e>>4&63]+d[e<<2&63]+"="));return o.join("")}},d=[],l=[],p="undefined"!=typeof Uint8Array?Uint8Array:Array,y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",g=0;g<64;++g)d[g]=y[g],l[y.charCodeAt(g)]=g;function m(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");return-1===n&&(n=e),[n,n===e?0:4-n%4]}function w(t,e,n){for(var r,o,i=[],s=e;s<n;s+=3)r=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),i.push(d[(o=r)>>18&63]+d[o>>12&63]+d[o>>6&63]+d[63&o]);return i.join("")}l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63;var b={
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
read:function(t,e,n,r,o){var i,s,a=8*o-r-1,u=(1<<a)-1,c=u>>1,f=-7,h=n?o-1:0,d=n?-1:1,l=t[e+h];for(h+=d,i=l&(1<<-f)-1,l>>=-f,f+=a;f>0;i=256*i+t[e+h],h+=d,f-=8);for(s=i&(1<<-f)-1,i>>=-f,f+=r;f>0;s=256*s+t[e+h],h+=d,f-=8);if(0===i)i=1-c;else{if(i===u)return s?NaN:1/0*(l?-1:1);s+=Math.pow(2,r),i-=c}return(l?-1:1)*s*Math.pow(2,i-r)},write:function(t,e,n,r,o,i){var s,a,u,c=8*i-o-1,f=(1<<c)-1,h=f>>1,d=23===o?Math.pow(2,-24)-Math.pow(2,-77):0,l=r?0:i-1,p=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=f):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),(e+=s+h>=1?d/u:d*Math.pow(2,1-h))*u>=2&&(s++,u/=2),s+h>=f?(a=0,s=f):s+h>=1?(a=(e*u-1)*Math.pow(2,o),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,o),s=0));o>=8;t[n+l]=255&a,l+=p,a/=256,o-=8);for(s=s<<o|a,c+=o;c>0;t[n+l]=255&s,l+=p,s/=256,c-=8);t[n+l-p]|=128*y}};
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */
!function(t){const e=h,n=b,r="function"==typeof Symbol&&"function"==typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.Buffer=s,t.SlowBuffer=function(t){+t!=t&&(t=0);return s.alloc(+t)},t.INSPECT_MAX_BYTES=50;const o=2147483647;function i(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');const e=new Uint8Array(t);return Object.setPrototypeOf(e,s.prototype),e}function s(t,e,n){if("number"==typeof t){if("string"==typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return c(t)}return a(t,e,n)}function a(t,e,n){if("string"==typeof t)return function(t,e){"string"==typeof e&&""!==e||(e="utf8");if(!s.isEncoding(e))throw new TypeError("Unknown encoding: "+e);const n=0|p(t,e);let r=i(n);const o=r.write(t,e);o!==n&&(r=r.slice(0,o));return r}(t,e);if(ArrayBuffer.isView(t))return function(t){if(Y(t,Uint8Array)){const e=new Uint8Array(t);return d(e.buffer,e.byteOffset,e.byteLength)}return f(t)}(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Y(t,ArrayBuffer)||t&&Y(t.buffer,ArrayBuffer))return d(t,e,n);if("undefined"!=typeof SharedArrayBuffer&&(Y(t,SharedArrayBuffer)||t&&Y(t.buffer,SharedArrayBuffer)))return d(t,e,n);if("number"==typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=t.valueOf&&t.valueOf();if(null!=r&&r!==t)return s.from(r,e,n);const o=function(t){if(s.isBuffer(t)){const e=0|l(t.length),n=i(e);return 0===n.length||t.copy(n,0,0,e),n}if(void 0!==t.length)return"number"!=typeof t.length||Z(t.length)?i(0):f(t);if("Buffer"===t.type&&Array.isArray(t.data))return f(t.data)}(t);if(o)return o;if("undefined"!=typeof Symbol&&null!=Symbol.toPrimitive&&"function"==typeof t[Symbol.toPrimitive])return s.from(t[Symbol.toPrimitive]("string"),e,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function c(t){return u(t),i(t<0?0:0|l(t))}function f(t){const e=t.length<0?0:0|l(t.length),n=i(e);for(let r=0;r<e;r+=1)n[r]=255&t[r];return n}function d(t,e,n){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===e&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,e):new Uint8Array(t,e,n),Object.setPrototypeOf(r,s.prototype),r}function l(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function p(t,e){if(s.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Y(t,ArrayBuffer))return t.byteLength;if("string"!=typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);const n=t.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let o=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(t).length;default:if(o)return r?-1:q(t).length;e=(""+e).toLowerCase(),o=!0}}function y(t,e,n){let r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return U(this,e,n);case"utf8":case"utf-8":return B(this,e,n);case"ascii":return T(this,e,n);case"latin1":case"binary":return L(this,e,n);case"base64":return A(this,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return P(this,e,n);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}function g(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function m(t,e,n,r,o){if(0===t.length)return-1;if("string"==typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Z(n=+n)&&(n=o?0:t.length-1),n<0&&(n=t.length+n),n>=t.length){if(o)return-1;n=t.length-1}else if(n<0){if(!o)return-1;n=0}if("string"==typeof e&&(e=s.from(e,r)),s.isBuffer(e))return 0===e.length?-1:w(t,e,n,r,o);if("number"==typeof e)return e&=255,"function"==typeof Uint8Array.prototype.indexOf?o?Uint8Array.prototype.indexOf.call(t,e,n):Uint8Array.prototype.lastIndexOf.call(t,e,n):w(t,[e],n,r,o);throw new TypeError("val must be string, number or Buffer")}function w(t,e,n,r,o){let i,s=1,a=t.length,u=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;s=2,a/=2,u/=2,n/=2}function c(t,e){return 1===s?t[e]:t.readUInt16BE(e*s)}if(o){let r=-1;for(i=n;i<a;i++)if(c(t,i)===c(e,-1===r?0:i-r)){if(-1===r&&(r=i),i-r+1===u)return r*s}else-1!==r&&(i-=i-r),r=-1}else for(n+u>a&&(n=a-u),i=n;i>=0;i--){let n=!0;for(let r=0;r<u;r++)if(c(t,i+r)!==c(e,r)){n=!1;break}if(n)return i}return-1}function E(t,e,n,r){n=Number(n)||0;const o=t.length-n;r?(r=Number(r))>o&&(r=o):r=o;const i=e.length;let s;for(r>i/2&&(r=i/2),s=0;s<r;++s){const r=parseInt(e.substr(2*s,2),16);if(Z(r))return s;t[n+s]=r}return s}function k(t,e,n,r){return J(q(e,t.length-n),t,n,r)}function I(t,e,n,r){return J(function(t){const e=[];for(let n=0;n<t.length;++n)e.push(255&t.charCodeAt(n));return e}(e),t,n,r)}function v(t,e,n,r){return J(H(e),t,n,r)}function S(t,e,n,r){return J(function(t,e){let n,r,o;const i=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)n=t.charCodeAt(s),r=n>>8,o=n%256,i.push(o),i.push(r);return i}(e,t.length-n),t,n,r)}function A(t,n,r){return 0===n&&r===t.length?e.fromByteArray(t):e.fromByteArray(t.slice(n,r))}function B(t,e,n){n=Math.min(t.length,n);const r=[];let o=e;for(;o<n;){const e=t[o];let i=null,s=e>239?4:e>223?3:e>191?2:1;if(o+s<=n){let n,r,a,u;switch(s){case 1:e<128&&(i=e);break;case 2:n=t[o+1],128==(192&n)&&(u=(31&e)<<6|63&n,u>127&&(i=u));break;case 3:n=t[o+1],r=t[o+2],128==(192&n)&&128==(192&r)&&(u=(15&e)<<12|(63&n)<<6|63&r,u>2047&&(u<55296||u>57343)&&(i=u));break;case 4:n=t[o+1],r=t[o+2],a=t[o+3],128==(192&n)&&128==(192&r)&&128==(192&a)&&(u=(15&e)<<18|(63&n)<<12|(63&r)<<6|63&a,u>65535&&u<1114112&&(i=u))}}null===i?(i=65533,s=1):i>65535&&(i-=65536,r.push(i>>>10&1023|55296),i=56320|1023&i),r.push(i),o+=s}return function(t){const e=t.length;if(e<=x)return String.fromCharCode.apply(String,t);let n="",r=0;for(;r<e;)n+=String.fromCharCode.apply(String,t.slice(r,r+=x));return n}(r)}t.kMaxLength=o,s.TYPED_ARRAY_SUPPORT=function(){try{const t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(t){return!1}}(),s.TYPED_ARRAY_SUPPORT||"undefined"==typeof console||"function"!=typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(s.prototype,"parent",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.buffer}}),Object.defineProperty(s.prototype,"offset",{enumerable:!0,get:function(){if(s.isBuffer(this))return this.byteOffset}}),s.poolSize=8192,s.from=function(t,e,n){return a(t,e,n)},Object.setPrototypeOf(s.prototype,Uint8Array.prototype),Object.setPrototypeOf(s,Uint8Array),s.alloc=function(t,e,n){return function(t,e,n){return u(t),t<=0?i(t):void 0!==e?"string"==typeof n?i(t).fill(e,n):i(t).fill(e):i(t)}(t,e,n)},s.allocUnsafe=function(t){return c(t)},s.allocUnsafeSlow=function(t){return c(t)},s.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==s.prototype},s.compare=function(t,e){if(Y(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),Y(e,Uint8Array)&&(e=s.from(e,e.offset,e.byteLength)),!s.isBuffer(t)||!s.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;let n=t.length,r=e.length;for(let o=0,i=Math.min(n,r);o<i;++o)if(t[o]!==e[o]){n=t[o],r=e[o];break}return n<r?-1:r<n?1:0},s.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},s.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return s.alloc(0);let n;if(void 0===e)for(e=0,n=0;n<t.length;++n)e+=t[n].length;const r=s.allocUnsafe(e);let o=0;for(n=0;n<t.length;++n){let e=t[n];if(Y(e,Uint8Array))o+e.length>r.length?(s.isBuffer(e)||(e=s.from(e)),e.copy(r,o)):Uint8Array.prototype.set.call(r,e,o);else{if(!s.isBuffer(e))throw new TypeError('"list" argument must be an Array of Buffers');e.copy(r,o)}o+=e.length}return r},s.byteLength=p,s.prototype._isBuffer=!0,s.prototype.swap16=function(){const t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let e=0;e<t;e+=2)g(this,e,e+1);return this},s.prototype.swap32=function(){const t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let e=0;e<t;e+=4)g(this,e,e+3),g(this,e+1,e+2);return this},s.prototype.swap64=function(){const t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let e=0;e<t;e+=8)g(this,e,e+7),g(this,e+1,e+6),g(this,e+2,e+5),g(this,e+3,e+4);return this},s.prototype.toString=function(){const t=this.length;return 0===t?"":0===arguments.length?B(this,0,t):y.apply(this,arguments)},s.prototype.toLocaleString=s.prototype.toString,s.prototype.equals=function(t){if(!s.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===s.compare(this,t)},s.prototype.inspect=function(){let e="";const n=t.INSPECT_MAX_BYTES;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},r&&(s.prototype[r]=s.prototype.inspect),s.prototype.compare=function(t,e,n,r,o){if(Y(t,Uint8Array)&&(t=s.from(t,t.offset,t.byteLength)),!s.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===n&&(n=t?t.length:0),void 0===r&&(r=0),void 0===o&&(o=this.length),e<0||n>t.length||r<0||o>this.length)throw new RangeError("out of range index");if(r>=o&&e>=n)return 0;if(r>=o)return-1;if(e>=n)return 1;if(this===t)return 0;let i=(o>>>=0)-(r>>>=0),a=(n>>>=0)-(e>>>=0);const u=Math.min(i,a),c=this.slice(r,o),f=t.slice(e,n);for(let t=0;t<u;++t)if(c[t]!==f[t]){i=c[t],a=f[t];break}return i<a?-1:a<i?1:0},s.prototype.includes=function(t,e,n){return-1!==this.indexOf(t,e,n)},s.prototype.indexOf=function(t,e,n){return m(this,t,e,n,!0)},s.prototype.lastIndexOf=function(t,e,n){return m(this,t,e,n,!1)},s.prototype.write=function(t,e,n,r){if(void 0===e)r="utf8",n=this.length,e=0;else if(void 0===n&&"string"==typeof e)r=e,n=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const o=this.length-e;if((void 0===n||n>o)&&(n=o),t.length>0&&(n<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let i=!1;for(;;)switch(r){case"hex":return E(this,t,e,n);case"utf8":case"utf-8":return k(this,t,e,n);case"ascii":case"latin1":case"binary":return I(this,t,e,n);case"base64":return v(this,t,e,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,t,e,n);default:if(i)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),i=!0}},s.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const x=4096;function T(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(127&t[o]);return r}function L(t,e,n){let r="";n=Math.min(t.length,n);for(let o=e;o<n;++o)r+=String.fromCharCode(t[o]);return r}function U(t,e,n){const r=t.length;(!e||e<0)&&(e=0),(!n||n<0||n>r)&&(n=r);let o="";for(let r=e;r<n;++r)o+=K[t[r]];return o}function P(t,e,n){const r=t.slice(e,n);let o="";for(let t=0;t<r.length-1;t+=2)o+=String.fromCharCode(r[t]+256*r[t+1]);return o}function O(t,e,n){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>n)throw new RangeError("Trying to access beyond buffer length")}function C(t,e,n,r,o,i){if(!s.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>o||e<i)throw new RangeError('"value" argument is out of bounds');if(n+r>t.length)throw new RangeError("Index out of range")}function M(t,e,n,r,o){W(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i,i>>=8,t[n++]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,s>>=8,t[n++]=s,n}function D(t,e,n,r,o){W(e,r,o,t,n,7);let i=Number(e&BigInt(4294967295));t[n+7]=i,i>>=8,t[n+6]=i,i>>=8,t[n+5]=i,i>>=8,t[n+4]=i;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[n+3]=s,s>>=8,t[n+2]=s,s>>=8,t[n+1]=s,s>>=8,t[n]=s,n+8}function R(t,e,n,r,o,i){if(n+r>t.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function z(t,e,r,o,i){return e=+e,r>>>=0,i||R(t,0,r,4),n.write(t,e,r,o,23,4),r+4}function F(t,e,r,o,i){return e=+e,r>>>=0,i||R(t,0,r,8),n.write(t,e,r,o,52,8),r+8}s.prototype.slice=function(t,e){const n=this.length;(t=~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),(e=void 0===e?n:~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),e<t&&(e=t);const r=this.subarray(t,e);return Object.setPrototypeOf(r,s.prototype),r},s.prototype.readUintLE=s.prototype.readUIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return r},s.prototype.readUintBE=s.prototype.readUIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t+--e],o=1;for(;e>0&&(o*=256);)r+=this[t+--e]*o;return r},s.prototype.readUint8=s.prototype.readUInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),this[t]},s.prototype.readUint16LE=s.prototype.readUInt16LE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]|this[t+1]<<8},s.prototype.readUint16BE=s.prototype.readUInt16BE=function(t,e){return t>>>=0,e||O(t,2,this.length),this[t]<<8|this[t+1]},s.prototype.readUint32LE=s.prototype.readUInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},s.prototype.readUint32BE=s.prototype.readUInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},s.prototype.readBigUInt64LE=X((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const r=e+256*this[++t]+65536*this[++t]+this[++t]*2**24,o=this[++t]+256*this[++t]+65536*this[++t]+n*2**24;return BigInt(r)+(BigInt(o)<<BigInt(32))})),s.prototype.readBigUInt64BE=X((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const r=e*2**24+65536*this[++t]+256*this[++t]+this[++t],o=this[++t]*2**24+65536*this[++t]+256*this[++t]+n;return(BigInt(r)<<BigInt(32))+BigInt(o)})),s.prototype.readIntLE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=this[t],o=1,i=0;for(;++i<e&&(o*=256);)r+=this[t+i]*o;return o*=128,r>=o&&(r-=Math.pow(2,8*e)),r},s.prototype.readIntBE=function(t,e,n){t>>>=0,e>>>=0,n||O(t,e,this.length);let r=e,o=1,i=this[t+--r];for(;r>0&&(o*=256);)i+=this[t+--r]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*e)),i},s.prototype.readInt8=function(t,e){return t>>>=0,e||O(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},s.prototype.readInt16LE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t]|this[t+1]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt16BE=function(t,e){t>>>=0,e||O(t,2,this.length);const n=this[t+1]|this[t]<<8;return 32768&n?4294901760|n:n},s.prototype.readInt32LE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},s.prototype.readInt32BE=function(t,e){return t>>>=0,e||O(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},s.prototype.readBigInt64LE=X((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const r=this[t+4]+256*this[t+5]+65536*this[t+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(e+256*this[++t]+65536*this[++t]+this[++t]*2**24)})),s.prototype.readBigInt64BE=X((function(t){V(t>>>=0,"offset");const e=this[t],n=this[t+7];void 0!==e&&void 0!==n||$(t,this.length-8);const r=(e<<24)+65536*this[++t]+256*this[++t]+this[++t];return(BigInt(r)<<BigInt(32))+BigInt(this[++t]*2**24+65536*this[++t]+256*this[++t]+n)})),s.prototype.readFloatLE=function(t,e){return t>>>=0,e||O(t,4,this.length),n.read(this,t,!0,23,4)},s.prototype.readFloatBE=function(t,e){return t>>>=0,e||O(t,4,this.length),n.read(this,t,!1,23,4)},s.prototype.readDoubleLE=function(t,e){return t>>>=0,e||O(t,8,this.length),n.read(this,t,!0,52,8)},s.prototype.readDoubleBE=function(t,e){return t>>>=0,e||O(t,8,this.length),n.read(this,t,!1,52,8)},s.prototype.writeUintLE=s.prototype.writeUIntLE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){C(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=1,i=0;for(this[e]=255&t;++i<n&&(o*=256);)this[e+i]=t/o&255;return e+n},s.prototype.writeUintBE=s.prototype.writeUIntBE=function(t,e,n,r){if(t=+t,e>>>=0,n>>>=0,!r){C(this,t,e,n,Math.pow(2,8*n)-1,0)}let o=n-1,i=1;for(this[e+o]=255&t;--o>=0&&(i*=256);)this[e+o]=t/i&255;return e+n},s.prototype.writeUint8=s.prototype.writeUInt8=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,1,255,0),this[e]=255&t,e+1},s.prototype.writeUint16LE=s.prototype.writeUInt16LE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeUint16BE=s.prototype.writeUInt16BE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeUint32LE=s.prototype.writeUInt32LE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},s.prototype.writeUint32BE=s.prototype.writeUInt32BE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigUInt64LE=X((function(t,e=0){return M(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeBigUInt64BE=X((function(t,e=0){return D(this,t,e,BigInt(0),BigInt("0xffffffffffffffff"))})),s.prototype.writeIntLE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);C(this,t,e,n,r-1,-r)}let o=0,i=1,s=0;for(this[e]=255&t;++o<n&&(i*=256);)t<0&&0===s&&0!==this[e+o-1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},s.prototype.writeIntBE=function(t,e,n,r){if(t=+t,e>>>=0,!r){const r=Math.pow(2,8*n-1);C(this,t,e,n,r-1,-r)}let o=n-1,i=1,s=0;for(this[e+o]=255&t;--o>=0&&(i*=256);)t<0&&0===s&&0!==this[e+o+1]&&(s=1),this[e+o]=(t/i>>0)-s&255;return e+n},s.prototype.writeInt8=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},s.prototype.writeInt16LE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},s.prototype.writeInt16BE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},s.prototype.writeInt32LE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},s.prototype.writeInt32BE=function(t,e,n){return t=+t,e>>>=0,n||C(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},s.prototype.writeBigInt64LE=X((function(t,e=0){return M(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeBigInt64BE=X((function(t,e=0){return D(this,t,e,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),s.prototype.writeFloatLE=function(t,e,n){return z(this,t,e,!0,n)},s.prototype.writeFloatBE=function(t,e,n){return z(this,t,e,!1,n)},s.prototype.writeDoubleLE=function(t,e,n){return F(this,t,e,!0,n)},s.prototype.writeDoubleBE=function(t,e,n){return F(this,t,e,!1,n)},s.prototype.copy=function(t,e,n,r){if(!s.isBuffer(t))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-n&&(r=t.length-e+n);const o=r-n;return this===t&&"function"==typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,n,r):Uint8Array.prototype.set.call(t,this.subarray(n,r),e),o},s.prototype.fill=function(t,e,n,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,n=this.length):"string"==typeof n&&(r=n,n=this.length),void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!s.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===t.length){const e=t.charCodeAt(0);("utf8"===r&&e<128||"latin1"===r)&&(t=e)}}else"number"==typeof t?t&=255:"boolean"==typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<n)throw new RangeError("Out of range index");if(n<=e)return this;let o;if(e>>>=0,n=void 0===n?this.length:n>>>0,t||(t=0),"number"==typeof t)for(o=e;o<n;++o)this[o]=t;else{const i=s.isBuffer(t)?t:s.from(t,r),a=i.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(o=0;o<n-e;++o)this[o+e]=i[o%a]}return this};const N={};function _(t,e,n){N[t]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(t){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:t,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}function j(t){let e="",n=t.length;const r="-"===t[0]?1:0;for(;n>=r+4;n-=3)e=`_${t.slice(n-3,n)}${e}`;return`${t.slice(0,n)}${e}`}function W(t,e,n,r,o,i){if(t>n||t<e){const r="bigint"==typeof e?"n":"";let o;throw o=i>3?0===e||e===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(i+1)}${r}`:`>= -(2${r} ** ${8*(i+1)-1}${r}) and < 2 ** ${8*(i+1)-1}${r}`:`>= ${e}${r} and <= ${n}${r}`,new N.ERR_OUT_OF_RANGE("value",o,t)}!function(t,e,n){V(e,"offset"),void 0!==t[e]&&void 0!==t[e+n]||$(e,t.length-(n+1))}(r,o,i)}function V(t,e){if("number"!=typeof t)throw new N.ERR_INVALID_ARG_TYPE(e,"number",t)}function $(t,e,n){if(Math.floor(t)!==t)throw V(t,n),new N.ERR_OUT_OF_RANGE(n||"offset","an integer",t);if(e<0)throw new N.ERR_BUFFER_OUT_OF_BOUNDS;throw new N.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${e}`,t)}_("ERR_BUFFER_OUT_OF_BOUNDS",(function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),_("ERR_INVALID_ARG_TYPE",(function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`}),TypeError),_("ERR_OUT_OF_RANGE",(function(t,e,n){let r=`The value of "${t}" is out of range.`,o=n;return Number.isInteger(n)&&Math.abs(n)>2**32?o=j(String(n)):"bigint"==typeof n&&(o=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(o=j(o)),o+="n"),r+=` It must be ${e}. Received ${o}`,r}),RangeError);const G=/[^+/0-9A-Za-z-_]/g;function q(t,e){let n;e=e||1/0;const r=t.length;let o=null;const i=[];for(let s=0;s<r;++s){if(n=t.charCodeAt(s),n>55295&&n<57344){if(!o){if(n>56319){(e-=3)>-1&&i.push(239,191,189);continue}if(s+1===r){(e-=3)>-1&&i.push(239,191,189);continue}o=n;continue}if(n<56320){(e-=3)>-1&&i.push(239,191,189),o=n;continue}n=65536+(o-55296<<10|n-56320)}else o&&(e-=3)>-1&&i.push(239,191,189);if(o=null,n<128){if((e-=1)<0)break;i.push(n)}else if(n<2048){if((e-=2)<0)break;i.push(n>>6|192,63&n|128)}else if(n<65536){if((e-=3)<0)break;i.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;i.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return i}function H(t){return e.toByteArray(function(t){if((t=(t=t.split("=")[0]).trim().replace(G,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function J(t,e,n,r){let o;for(o=0;o<r&&!(o+n>=e.length||o>=t.length);++o)e[o+n]=t[o];return o}function Y(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!=t}const K=function(){const t="0123456789abcdef",e=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let o=0;o<16;++o)e[r+o]=t[n]+t[o]}return e}();function X(t){return"undefined"==typeof BigInt?Q:t}function Q(){throw new Error("BigInt not supported")}}(f);var E={};Object.defineProperty(E,"__esModule",{value:!0}),E.s16=E.s8=E.nu64be=E.u48be=E.u40be=E.u32be=E.u24be=E.u16be=E.nu64=E.u48=E.u40=E.u32=E.u24=E.u16=ot=E.u8=E.offset=E.greedy=E.Constant=E.UTF8=E.CString=E.Blob=E.Boolean=E.BitField=E.BitStructure=E.VariantLayout=E.Union=E.UnionLayoutDiscriminator=E.UnionDiscriminator=E.Structure=E.Sequence=E.DoubleBE=E.Double=E.FloatBE=E.Float=E.NearInt64BE=E.NearInt64=E.NearUInt64BE=E.NearUInt64=E.IntBE=E.Int=E.UIntBE=E.UInt=E.OffsetLayout=E.GreedyCount=E.ExternalLayout=E.bindConstructorLayout=E.nameWithProperty=E.Layout=E.uint8ArrayToBuffer=E.checkUint8Array=void 0,E.constant=E.utf8=E.cstr=st=E.blob=E.unionLayoutDiscriminator=E.union=E.seq=E.bits=it=E.struct=E.f64be=E.f64=E.f32be=E.f32=E.ns64be=E.s48be=E.s40be=E.s32be=E.s24be=E.s16be=E.ns64=E.s48=E.s40=E.s32=E.s24=void 0;const k=f;function I(t){if(!(t instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function v(t){return I(t),k.Buffer.from(t.buffer,t.byteOffset,t.length)}E.checkUint8Array=I,E.uint8ArrayToBuffer=v;class S{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}function A(t,e){return e.property?t+"["+e.property+"]":t}E.Layout=S,E.nameWithProperty=A,E.bindConstructorLayout=function(t,e){if("function"!=typeof t)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(t,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof S))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");t.layout_=e,e.boundConstructor_=t,e.makeDestinationObject=()=>new t,Object.defineProperty(t.prototype,"encode",{value(t,n){return e.encode(this,t,n)},writable:!0}),Object.defineProperty(t,"decode",{value:(t,n)=>e.decode(t,n),writable:!0})};class B extends S{isCount(){throw new Error("ExternalLayout is abstract")}}E.ExternalLayout=B;class x extends B{constructor(t=1,e){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e=0){I(t);const n=t.length-e;return Math.floor(n/this.elementSpan)}encode(t,e,n){return 0}}E.GreedyCount=x;class T extends B{constructor(t,e=0,n){if(!(t instanceof S))throw new TypeError("layout must be a Layout");if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,n||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof L||this.layout instanceof U}decode(t,e=0){return this.layout.decode(t,e+this.offset)}encode(t,e,n=0){return this.layout.encode(t,e,n+this.offset)}}E.OffsetLayout=T;class L extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return v(t).readUIntLE(e,this.span)}encode(t,e,n=0){return v(e).writeUIntLE(t,n,this.span),this.span}}E.UInt=L;class U extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return v(t).readUIntBE(e,this.span)}encode(t,e,n=0){return v(e).writeUIntBE(t,n,this.span),this.span}}E.UIntBE=U;class P extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return v(t).readIntLE(e,this.span)}encode(t,e,n=0){return v(e).writeIntLE(t,n,this.span),this.span}}E.Int=P;class O extends S{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return v(t).readIntBE(e,this.span)}encode(t,e,n=0){return v(e).writeIntBE(t,n,this.span),this.span}}E.IntBE=O;const C=Math.pow(2,32);function M(t){const e=Math.floor(t/C);return{hi32:e,lo32:t-e*C}}function D(t,e){return t*C+e}class R extends S{constructor(t){super(8,t)}decode(t,e=0){const n=v(t),r=n.readUInt32LE(e);return D(n.readUInt32LE(e+4),r)}encode(t,e,n=0){const r=M(t),o=v(e);return o.writeUInt32LE(r.lo32,n),o.writeUInt32LE(r.hi32,n+4),8}}E.NearUInt64=R;class z extends S{constructor(t){super(8,t)}decode(t,e=0){const n=v(t);return D(n.readUInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=M(t),o=v(e);return o.writeUInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}E.NearUInt64BE=z;class F extends S{constructor(t){super(8,t)}decode(t,e=0){const n=v(t),r=n.readUInt32LE(e);return D(n.readInt32LE(e+4),r)}encode(t,e,n=0){const r=M(t),o=v(e);return o.writeUInt32LE(r.lo32,n),o.writeInt32LE(r.hi32,n+4),8}}E.NearInt64=F;class N extends S{constructor(t){super(8,t)}decode(t,e=0){const n=v(t);return D(n.readInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=M(t),o=v(e);return o.writeInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}E.NearInt64BE=N;class _ extends S{constructor(t){super(4,t)}decode(t,e=0){return v(t).readFloatLE(e)}encode(t,e,n=0){return v(e).writeFloatLE(t,n),4}}E.Float=_;class j extends S{constructor(t){super(4,t)}decode(t,e=0){return v(t).readFloatBE(e)}encode(t,e,n=0){return v(e).writeFloatBE(t,n),4}}E.FloatBE=j;class W extends S{constructor(t){super(8,t)}decode(t,e=0){return v(t).readDoubleLE(e)}encode(t,e,n=0){return v(e).writeDoubleLE(t,n),8}}E.Double=W;class V extends S{constructor(t){super(8,t)}decode(t,e=0){return v(t).readDoubleBE(e)}encode(t,e,n=0){return v(e).writeDoubleBE(t,n),8}}E.DoubleBE=V;class $ extends S{constructor(t,e,n){if(!(t instanceof S))throw new TypeError("elementLayout must be a Layout");if(!(e instanceof B&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let r=-1;!(e instanceof B)&&0<t.span&&(r=e*t.span),super(r,n),this.elementLayout=t,this.count=e}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0,r=this.count;if(r instanceof B&&(r=r.decode(t,e)),0<this.elementLayout.span)n=r*this.elementLayout.span;else{let o=0;for(;o<r;)n+=this.elementLayout.getSpan(t,e+n),++o}return n}decode(t,e=0){const n=[];let r=0,o=this.count;for(o instanceof B&&(o=o.decode(t,e));r<o;)n.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),r+=1;return n}encode(t,e,n=0){const r=this.elementLayout,o=t.reduce(((t,o)=>t+r.encode(o,e,n+t)),0);return this.count instanceof B&&this.count.encode(t.length,e,n),o}}E.Sequence=$;class G extends S{constructor(t,e,n){if(!Array.isArray(t)||!t.reduce(((t,e)=>t&&e instanceof S),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof e&&void 0===n&&(n=e,e=void 0);for(const e of t)if(0>e.span&&void 0===e.property)throw new Error("fields cannot contain unnamed variable-length layout");let r=-1;try{r=t.reduce(((t,e)=>t+e.getSpan()),0)}catch(t){}super(r,e),this.fields=t,this.decodePrefixes=!!n}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;try{n=this.fields.reduce(((n,r)=>{const o=r.getSpan(t,e);return e+=o,n+o}),0)}catch(t){throw new RangeError("indeterminate span")}return n}decode(t,e=0){I(t);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(t,e)),e+=r.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return n}encode(t,e,n=0){const r=n;let o=0,i=0;for(const r of this.fields){let s=r.span;if(i=0<s?s:0,void 0!==r.property){const o=t[r.property];void 0!==o&&(i=r.encode(o,e,n),0>s&&(s=r.getSpan(e,n)))}o=n,n+=s}return o+i-r}fromArray(t){const e=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<t.length&&(e[n.property]=t.shift());return e}layoutFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if("string"!=typeof t)throw new TypeError("property must be string");let e=0;for(const n of this.fields){if(n.property===t)return e;0>n.span?e=-1:0<=e&&(e+=n.span)}}}E.Structure=G;class q{constructor(t){this.property=t}decode(t,e){throw new Error("UnionDiscriminator is abstract")}encode(t,e,n){throw new Error("UnionDiscriminator is abstract")}}E.UnionDiscriminator=q;class H extends q{constructor(t,e){if(!(t instanceof B&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,n){return this.layout.encode(t,e,n)}}E.UnionLayoutDiscriminator=H;class J extends S{constructor(t,e,n){let r;if(t instanceof L||t instanceof U)r=new H(new T(t));else if(t instanceof B&&t.isCount())r=new H(t);else{if(!(t instanceof q))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");r=t}if(void 0===e&&(e=null),!(null===e||e instanceof S))throw new TypeError("defaultLayout must be null or a Layout");if(null!==e){if(0>e.span)throw new Error("defaultLayout must have constant span");void 0===e.property&&(e=e.replicate("content"))}let o=-1;e&&(o=e.span,0<=o&&(t instanceof L||t instanceof U)&&(o+=r.layout.span)),super(o,n),this.discriminator=r,this.usesPrefixDiscriminator=t instanceof L||t instanceof U,this.defaultLayout=e,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(t){return i(t)},this.configGetSourceVariant=function(t){i=t.bind(this)}}getSpan(t,e=0){if(0<=this.span)return this.span;const n=this.getVariant(t,e);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(t,e)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||e.property&&Object.prototype.hasOwnProperty.call(t,e.property)))return e}else for(const e in this.registry){const n=this.registry[e];if(n.property&&Object.prototype.hasOwnProperty.call(t,n.property))return n}throw new Error("unable to infer src variant")}decode(t,e=0){let n;const r=this.discriminator,o=r.decode(t,e),i=this.registry[o];if(void 0===i){const i=this.defaultLayout;let s=0;this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=o,n[i.property]=i.decode(t,e+s)}else n=i.decode(t,e);return n}encode(t,e,n=0){const r=this.getSourceVariant(t);if(void 0===r){const r=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=r.layout.span),r.encode(t[r.property],e,n),i+o.encode(t[o.property],e,n+i)}return r.encode(t,e,n)}addVariant(t,e,n){const r=new Y(this,t,e,n);return this.registry[t]=r,r}getVariant(t,e=0){let n;return n=t instanceof Uint8Array?this.discriminator.decode(t,e):t,this.registry[n]}}E.Union=J;class Y extends S{constructor(t,e,n,r){if(!(t instanceof J))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof S))throw new TypeError("layout must be a Layout");if(null!==t.defaultLayout&&0<=n.span&&n.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let o=t.span;0>t.span&&(o=n?n.span:0,0<=o&&t.usesPrefixDiscriminator&&(o+=t.discriminator.layout.span)),super(o,r),this.union=t,this.variant=e,this.layout=n||null}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span);let r=0;return this.layout&&(r=this.layout.getSpan(t,e+n)),n+r}decode(t,e=0){const n=this.makeDestinationObject();if(this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(t,e+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(t,e,n=0){let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,n);let o=r;if(this.layout&&(this.layout.encode(t[this.property],e,n+r),o+=this.layout.getSpan(e,n+r),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}function Z(t){return 0>t&&(t+=4294967296),t}E.VariantLayout=Y;class K extends S{constructor(t,e,n){if(!(t instanceof L||t instanceof U))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof e&&void 0===n&&(n=e,e=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,n),this.word=t,this.msb=!!e,this.fields=[];let r=0;this._packedSetValue=function(t){return r=Z(t),this},this._packedGetValue=function(){return r}}decode(t,e=0){const n=this.makeDestinationObject(),r=this.word.decode(t,e);this._packedSetValue(r);for(const e of this.fields)void 0!==e.property&&(n[e.property]=e.decode(t));return n}encode(t,e,n=0){const r=this.word.decode(e,n);this._packedSetValue(r);for(const e of this.fields)if(void 0!==e.property){const n=t[e.property];void 0!==n&&e.encode(n)}return this.word.encode(this._packedGetValue(),e,n)}addField(t,e){const n=new X(this,t,e);return this.fields.push(n),n}addBoolean(t){const e=new Q(this,t);return this.fields.push(e),e}fieldFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}E.BitStructure=K;class X{constructor(t,e,n){if(!(t instanceof K))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const r=8*t.span,o=t.fields.reduce(((t,e)=>t+e.bits),0);if(e+o>r)throw new Error("bits too long for span remainder ("+(r-o)+" of "+r+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,32===e&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=r-o-e),this.wordMask=Z(this.valueMask<<this.start),this.property=n}decode(t,e){return Z(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(t){if("number"!=typeof t||!Number.isInteger(t)||t!==Z(t&this.valueMask))throw new TypeError(A("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const e=this.container._packedGetValue(),n=Z(t<<this.start);this.container._packedSetValue(Z(e&~this.wordMask)|n)}}E.BitField=X;class Q extends X{constructor(t,e){super(t,1,e)}decode(t,e){return!!super.decode(t,e)}encode(t){"boolean"==typeof t&&(t=+t),super.encode(t)}}E.Boolean=Q;class tt extends S{constructor(t,e){if(!(t instanceof B&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;t instanceof B||(n=t),super(n,e),this.length=t}getSpan(t,e){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),n}decode(t,e=0){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),v(t).slice(e,e+n)}encode(t,e,n){let r=this.length;if(this.length instanceof B&&(r=t.length),!(t instanceof Uint8Array&&r===t.length))throw new TypeError(A("Blob.encode",this)+" requires (length "+r+") Uint8Array as src");if(n+r>e.length)throw new RangeError("encoding overruns Uint8Array");const o=v(t);return v(e).write(o.toString("hex"),n,r,"hex"),this.length instanceof B&&this.length.encode(r,e,n),r}}E.Blob=tt;class et extends S{constructor(t){super(-1,t)}getSpan(t,e=0){I(t);let n=e;for(;n<t.length&&0!==t[n];)n+=1;return 1+n-e}decode(t,e=0){const n=this.getSpan(t,e);return v(t).slice(e,e+n-1).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=k.Buffer.from(t,"utf8"),o=r.length;if(n+o>e.length)throw new RangeError("encoding overruns Buffer");const i=v(e);return r.copy(i,n),i[n+o]=0,o+1}}E.CString=et;class nt extends S{constructor(t,e){if("string"==typeof t&&void 0===e&&(e=t,t=void 0),void 0===t)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e=0){return I(t),t.length-e}decode(t,e=0){const n=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<n)throw new RangeError("text length exceeds maxSpan");return v(t).slice(e,e+n).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=k.Buffer.from(t,"utf8"),o=r.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(n+o>e.length)throw new RangeError("encoding overruns Buffer");return r.copy(v(e),n),o}}E.UTF8=nt;class rt extends S{constructor(t,e){super(0,e),this.value=t}decode(t,e){return this.value}encode(t,e,n){return 0}}E.Constant=rt,E.greedy=(t,e)=>new x(t,e),E.offset=(t,e,n)=>new T(t,e,n);var ot=E.u8=t=>new L(1,t);E.u16=t=>new L(2,t),E.u24=t=>new L(3,t),E.u32=t=>new L(4,t),E.u40=t=>new L(5,t),E.u48=t=>new L(6,t),E.nu64=t=>new R(t),E.u16be=t=>new U(2,t),E.u24be=t=>new U(3,t),E.u32be=t=>new U(4,t),E.u40be=t=>new U(5,t),E.u48be=t=>new U(6,t),E.nu64be=t=>new z(t),E.s8=t=>new P(1,t),E.s16=t=>new P(2,t),E.s24=t=>new P(3,t),E.s32=t=>new P(4,t),E.s40=t=>new P(5,t),E.s48=t=>new P(6,t),E.ns64=t=>new F(t),E.s16be=t=>new O(2,t),E.s24be=t=>new O(3,t),E.s32be=t=>new O(4,t),E.s40be=t=>new O(5,t),E.s48be=t=>new O(6,t),E.ns64be=t=>new N(t),E.f32=t=>new _(t),E.f32be=t=>new j(t),E.f64=t=>new W(t),E.f64be=t=>new V(t);var it=E.struct=(t,e,n)=>new G(t,e,n);E.bits=(t,e,n)=>new K(t,e,n),E.seq=(t,e,n)=>new $(t,e,n),E.union=(t,e,n)=>new J(t,e,n),E.unionLayoutDiscriminator=(t,e)=>new H(t,e);var st=E.blob=(t,e)=>new tt(t,e);E.cstr=t=>new et(t),E.utf8=(t,e)=>new nt(t,e),E.constant=(t,e)=>new rt(t,e);const at=new r("TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA");new r("TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb");const ut=new r("ATokenGPvbdGVxr1b2hvZbsiqW5xWH25efTNsLJA8knL");new r("So11111111111111111111111111111111111111112"),new r("9pan9bMn5HatX4EJdBwg9VgCa7Uz5HL8N1m5D3NdXejP");var ct={};Object.defineProperty(ct,"__esModule",{value:!0});var ft=ct.s16=ct.s8=ct.nu64be=ct.u48be=ct.u40be=ct.u32be=ct.u24be=ct.u16be=ct.nu64=ct.u48=ct.u40=Zt=ct.u32=ct.u24=Yt=ct.u16=Jt=ct.u8=ct.offset=ct.greedy=ct.Constant=ct.UTF8=ct.CString=ct.Blob=ct.Boolean=ct.BitField=ct.BitStructure=ct.VariantLayout=ct.Union=ct.UnionLayoutDiscriminator=ct.UnionDiscriminator=ct.Structure=ct.Sequence=ct.DoubleBE=ct.Double=ct.FloatBE=ct.Float=ct.NearInt64BE=ct.NearInt64=ct.NearUInt64BE=ct.NearUInt64=ct.IntBE=ct.Int=ct.UIntBE=ct.UInt=ct.OffsetLayout=ct.GreedyCount=ct.ExternalLayout=ct.bindConstructorLayout=ct.nameWithProperty=ct.Layout=ct.uint8ArrayToBuffer=ct.checkUint8Array=void 0;ct.constant=ct.utf8=ct.cstr=ct.blob=ct.unionLayoutDiscriminator=ct.union=ct.seq=ct.bits=Xt=ct.struct=ct.f64be=ct.f64=ct.f32be=ct.f32=ct.ns64be=ct.s48be=ct.s40be=ct.s32be=ct.s24be=ct.s16be=Kt=ct.ns64=ct.s48=ct.s40=ct.s32=ct.s24=void 0;const ht=f;function dt(t){if(!(t instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function lt(t){return dt(t),ht.Buffer.from(t.buffer,t.byteOffset,t.length)}ct.checkUint8Array=dt,ct.uint8ArrayToBuffer=lt;class pt{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}function yt(t,e){return e.property?t+"["+e.property+"]":t}ct.Layout=pt,ct.nameWithProperty=yt,ct.bindConstructorLayout=function(t,e){if("function"!=typeof t)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(t,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof pt))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");t.layout_=e,e.boundConstructor_=t,e.makeDestinationObject=()=>new t,Object.defineProperty(t.prototype,"encode",{value(t,n){return e.encode(this,t,n)},writable:!0}),Object.defineProperty(t,"decode",{value:(t,n)=>e.decode(t,n),writable:!0})};class gt extends pt{isCount(){throw new Error("ExternalLayout is abstract")}}ct.ExternalLayout=gt;class mt extends gt{constructor(t=1,e){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e=0){dt(t);const n=t.length-e;return Math.floor(n/this.elementSpan)}encode(t,e,n){return 0}}ct.GreedyCount=mt;class wt extends gt{constructor(t,e=0,n){if(!(t instanceof pt))throw new TypeError("layout must be a Layout");if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,n||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof bt||this.layout instanceof Et}decode(t,e=0){return this.layout.decode(t,e+this.offset)}encode(t,e,n=0){return this.layout.encode(t,e,n+this.offset)}}ct.OffsetLayout=wt;class bt extends pt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return lt(t).readUIntLE(e,this.span)}encode(t,e,n=0){return lt(e).writeUIntLE(t,n,this.span),this.span}}ct.UInt=bt;class Et extends pt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return lt(t).readUIntBE(e,this.span)}encode(t,e,n=0){return lt(e).writeUIntBE(t,n,this.span),this.span}}ct.UIntBE=Et;class kt extends pt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return lt(t).readIntLE(e,this.span)}encode(t,e,n=0){return lt(e).writeIntLE(t,n,this.span),this.span}}ct.Int=kt;class It extends pt{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return lt(t).readIntBE(e,this.span)}encode(t,e,n=0){return lt(e).writeIntBE(t,n,this.span),this.span}}ct.IntBE=It;const vt=Math.pow(2,32);function St(t){const e=Math.floor(t/vt);return{hi32:e,lo32:t-e*vt}}function At(t,e){return t*vt+e}class Bt extends pt{constructor(t){super(8,t)}decode(t,e=0){const n=lt(t),r=n.readUInt32LE(e);return At(n.readUInt32LE(e+4),r)}encode(t,e,n=0){const r=St(t),o=lt(e);return o.writeUInt32LE(r.lo32,n),o.writeUInt32LE(r.hi32,n+4),8}}ct.NearUInt64=Bt;class xt extends pt{constructor(t){super(8,t)}decode(t,e=0){const n=lt(t);return At(n.readUInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=St(t),o=lt(e);return o.writeUInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}ct.NearUInt64BE=xt;class Tt extends pt{constructor(t){super(8,t)}decode(t,e=0){const n=lt(t),r=n.readUInt32LE(e);return At(n.readInt32LE(e+4),r)}encode(t,e,n=0){const r=St(t),o=lt(e);return o.writeUInt32LE(r.lo32,n),o.writeInt32LE(r.hi32,n+4),8}}ct.NearInt64=Tt;class Lt extends pt{constructor(t){super(8,t)}decode(t,e=0){const n=lt(t);return At(n.readInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=St(t),o=lt(e);return o.writeInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}ct.NearInt64BE=Lt;class Ut extends pt{constructor(t){super(4,t)}decode(t,e=0){return lt(t).readFloatLE(e)}encode(t,e,n=0){return lt(e).writeFloatLE(t,n),4}}ct.Float=Ut;class Pt extends pt{constructor(t){super(4,t)}decode(t,e=0){return lt(t).readFloatBE(e)}encode(t,e,n=0){return lt(e).writeFloatBE(t,n),4}}ct.FloatBE=Pt;class Ot extends pt{constructor(t){super(8,t)}decode(t,e=0){return lt(t).readDoubleLE(e)}encode(t,e,n=0){return lt(e).writeDoubleLE(t,n),8}}ct.Double=Ot;class Ct extends pt{constructor(t){super(8,t)}decode(t,e=0){return lt(t).readDoubleBE(e)}encode(t,e,n=0){return lt(e).writeDoubleBE(t,n),8}}ct.DoubleBE=Ct;class Mt extends pt{constructor(t,e,n){if(!(t instanceof pt))throw new TypeError("elementLayout must be a Layout");if(!(e instanceof gt&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let r=-1;!(e instanceof gt)&&0<t.span&&(r=e*t.span),super(r,n),this.elementLayout=t,this.count=e}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0,r=this.count;if(r instanceof gt&&(r=r.decode(t,e)),0<this.elementLayout.span)n=r*this.elementLayout.span;else{let o=0;for(;o<r;)n+=this.elementLayout.getSpan(t,e+n),++o}return n}decode(t,e=0){const n=[];let r=0,o=this.count;for(o instanceof gt&&(o=o.decode(t,e));r<o;)n.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),r+=1;return n}encode(t,e,n=0){const r=this.elementLayout,o=t.reduce(((t,o)=>t+r.encode(o,e,n+t)),0);return this.count instanceof gt&&this.count.encode(t.length,e,n),o}}ct.Sequence=Mt;class Dt extends pt{constructor(t,e,n){if(!Array.isArray(t)||!t.reduce(((t,e)=>t&&e instanceof pt),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof e&&void 0===n&&(n=e,e=void 0);for(const e of t)if(0>e.span&&void 0===e.property)throw new Error("fields cannot contain unnamed variable-length layout");let r=-1;try{r=t.reduce(((t,e)=>t+e.getSpan()),0)}catch(t){}super(r,e),this.fields=t,this.decodePrefixes=!!n}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;try{n=this.fields.reduce(((n,r)=>{const o=r.getSpan(t,e);return e+=o,n+o}),0)}catch(t){throw new RangeError("indeterminate span")}return n}decode(t,e=0){dt(t);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(t,e)),e+=r.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return n}encode(t,e,n=0){const r=n;let o=0,i=0;for(const r of this.fields){let s=r.span;if(i=0<s?s:0,void 0!==r.property){const o=t[r.property];void 0!==o&&(i=r.encode(o,e,n),0>s&&(s=r.getSpan(e,n)))}o=n,n+=s}return o+i-r}fromArray(t){const e=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<t.length&&(e[n.property]=t.shift());return e}layoutFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if("string"!=typeof t)throw new TypeError("property must be string");let e=0;for(const n of this.fields){if(n.property===t)return e;0>n.span?e=-1:0<=e&&(e+=n.span)}}}ct.Structure=Dt;class Rt{constructor(t){this.property=t}decode(t,e){throw new Error("UnionDiscriminator is abstract")}encode(t,e,n){throw new Error("UnionDiscriminator is abstract")}}ct.UnionDiscriminator=Rt;class zt extends Rt{constructor(t,e){if(!(t instanceof gt&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,n){return this.layout.encode(t,e,n)}}ct.UnionLayoutDiscriminator=zt;class Ft extends pt{constructor(t,e,n){let r;if(t instanceof bt||t instanceof Et)r=new zt(new wt(t));else if(t instanceof gt&&t.isCount())r=new zt(t);else{if(!(t instanceof Rt))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");r=t}if(void 0===e&&(e=null),!(null===e||e instanceof pt))throw new TypeError("defaultLayout must be null or a Layout");if(null!==e){if(0>e.span)throw new Error("defaultLayout must have constant span");void 0===e.property&&(e=e.replicate("content"))}let o=-1;e&&(o=e.span,0<=o&&(t instanceof bt||t instanceof Et)&&(o+=r.layout.span)),super(o,n),this.discriminator=r,this.usesPrefixDiscriminator=t instanceof bt||t instanceof Et,this.defaultLayout=e,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(t){return i(t)},this.configGetSourceVariant=function(t){i=t.bind(this)}}getSpan(t,e=0){if(0<=this.span)return this.span;const n=this.getVariant(t,e);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(t,e)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||e.property&&Object.prototype.hasOwnProperty.call(t,e.property)))return e}else for(const e in this.registry){const n=this.registry[e];if(n.property&&Object.prototype.hasOwnProperty.call(t,n.property))return n}throw new Error("unable to infer src variant")}decode(t,e=0){let n;const r=this.discriminator,o=r.decode(t,e),i=this.registry[o];if(void 0===i){const i=this.defaultLayout;let s=0;this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=o,n[i.property]=i.decode(t,e+s)}else n=i.decode(t,e);return n}encode(t,e,n=0){const r=this.getSourceVariant(t);if(void 0===r){const r=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=r.layout.span),r.encode(t[r.property],e,n),i+o.encode(t[o.property],e,n+i)}return r.encode(t,e,n)}addVariant(t,e,n){const r=new Nt(this,t,e,n);return this.registry[t]=r,r}getVariant(t,e=0){let n;return n=t instanceof Uint8Array?this.discriminator.decode(t,e):t,this.registry[n]}}ct.Union=Ft;class Nt extends pt{constructor(t,e,n,r){if(!(t instanceof Ft))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof pt))throw new TypeError("layout must be a Layout");if(null!==t.defaultLayout&&0<=n.span&&n.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let o=t.span;0>t.span&&(o=n?n.span:0,0<=o&&t.usesPrefixDiscriminator&&(o+=t.discriminator.layout.span)),super(o,r),this.union=t,this.variant=e,this.layout=n||null}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span);let r=0;return this.layout&&(r=this.layout.getSpan(t,e+n)),n+r}decode(t,e=0){const n=this.makeDestinationObject();if(this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(t,e+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(t,e,n=0){let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,n);let o=r;if(this.layout&&(this.layout.encode(t[this.property],e,n+r),o+=this.layout.getSpan(e,n+r),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}function _t(t){return 0>t&&(t+=4294967296),t}ct.VariantLayout=Nt;class jt extends pt{constructor(t,e,n){if(!(t instanceof bt||t instanceof Et))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof e&&void 0===n&&(n=e,e=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,n),this.word=t,this.msb=!!e,this.fields=[];let r=0;this._packedSetValue=function(t){return r=_t(t),this},this._packedGetValue=function(){return r}}decode(t,e=0){const n=this.makeDestinationObject(),r=this.word.decode(t,e);this._packedSetValue(r);for(const e of this.fields)void 0!==e.property&&(n[e.property]=e.decode(t));return n}encode(t,e,n=0){const r=this.word.decode(e,n);this._packedSetValue(r);for(const e of this.fields)if(void 0!==e.property){const n=t[e.property];void 0!==n&&e.encode(n)}return this.word.encode(this._packedGetValue(),e,n)}addField(t,e){const n=new Wt(this,t,e);return this.fields.push(n),n}addBoolean(t){const e=new Vt(this,t);return this.fields.push(e),e}fieldFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}ct.BitStructure=jt;class Wt{constructor(t,e,n){if(!(t instanceof jt))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const r=8*t.span,o=t.fields.reduce(((t,e)=>t+e.bits),0);if(e+o>r)throw new Error("bits too long for span remainder ("+(r-o)+" of "+r+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,32===e&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=r-o-e),this.wordMask=_t(this.valueMask<<this.start),this.property=n}decode(t,e){return _t(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(t){if("number"!=typeof t||!Number.isInteger(t)||t!==_t(t&this.valueMask))throw new TypeError(yt("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const e=this.container._packedGetValue(),n=_t(t<<this.start);this.container._packedSetValue(_t(e&~this.wordMask)|n)}}ct.BitField=Wt;class Vt extends Wt{constructor(t,e){super(t,1,e)}decode(t,e){return!!super.decode(t,e)}encode(t){"boolean"==typeof t&&(t=+t),super.encode(t)}}ct.Boolean=Vt;class $t extends pt{constructor(t,e){if(!(t instanceof gt&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;t instanceof gt||(n=t),super(n,e),this.length=t}getSpan(t,e){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),n}decode(t,e=0){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),lt(t).slice(e,e+n)}encode(t,e,n){let r=this.length;if(this.length instanceof gt&&(r=t.length),!(t instanceof Uint8Array&&r===t.length))throw new TypeError(yt("Blob.encode",this)+" requires (length "+r+") Uint8Array as src");if(n+r>e.length)throw new RangeError("encoding overruns Uint8Array");const o=lt(t);return lt(e).write(o.toString("hex"),n,r,"hex"),this.length instanceof gt&&this.length.encode(r,e,n),r}}ct.Blob=$t;class Gt extends pt{constructor(t){super(-1,t)}getSpan(t,e=0){dt(t);let n=e;for(;n<t.length&&0!==t[n];)n+=1;return 1+n-e}decode(t,e=0){const n=this.getSpan(t,e);return lt(t).slice(e,e+n-1).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=ht.Buffer.from(t,"utf8"),o=r.length;if(n+o>e.length)throw new RangeError("encoding overruns Buffer");const i=lt(e);return r.copy(i,n),i[n+o]=0,o+1}}ct.CString=Gt;class qt extends pt{constructor(t,e){if("string"==typeof t&&void 0===e&&(e=t,t=void 0),void 0===t)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e=0){return dt(t),t.length-e}decode(t,e=0){const n=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<n)throw new RangeError("text length exceeds maxSpan");return lt(t).slice(e,e+n).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=ht.Buffer.from(t,"utf8"),o=r.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(n+o>e.length)throw new RangeError("encoding overruns Buffer");return r.copy(lt(e),n),o}}ct.UTF8=qt;class Ht extends pt{constructor(t,e){super(0,e),this.value=t}decode(t,e){return this.value}encode(t,e,n){return 0}}ct.Constant=Ht,ct.greedy=(t,e)=>new mt(t,e),ct.offset=(t,e,n)=>new wt(t,e,n);var Jt=ct.u8=t=>new bt(1,t),Yt=ct.u16=t=>new bt(2,t);ct.u24=t=>new bt(3,t);var Zt=ct.u32=t=>new bt(4,t);ct.u40=t=>new bt(5,t),ct.u48=t=>new bt(6,t),ct.nu64=t=>new Bt(t),ct.u16be=t=>new Et(2,t),ct.u24be=t=>new Et(3,t),ct.u32be=t=>new Et(4,t),ct.u40be=t=>new Et(5,t),ct.u48be=t=>new Et(6,t),ct.nu64be=t=>new xt(t),ct.s8=t=>new kt(1,t),ft=ct.s16=t=>new kt(2,t),ct.s24=t=>new kt(3,t),ct.s32=t=>new kt(4,t),ct.s40=t=>new kt(5,t),ct.s48=t=>new kt(6,t);var Kt=ct.ns64=t=>new Tt(t);ct.s16be=t=>new It(2,t),ct.s24be=t=>new It(3,t),ct.s32be=t=>new It(4,t),ct.s40be=t=>new It(5,t),ct.s48be=t=>new It(6,t),ct.ns64be=t=>new Lt(t),ct.f32=t=>new Ut(t),ct.f32be=t=>new Pt(t),ct.f64=t=>new Ot(t),ct.f64be=t=>new Ct(t);var Xt=ct.struct=(t,e,n)=>new Dt(t,e,n);ct.bits=(t,e,n)=>new jt(t,e,n),ct.seq=(t,e,n)=>new Mt(t,e,n),ct.union=(t,e,n)=>new Ft(t,e,n),ct.unionLayoutDiscriminator=(t,e)=>new zt(t,e),ct.blob=(t,e)=>new $t(t,e),ct.cstr=t=>new Gt(t),ct.utf8=(t,e)=>new qt(t,e),ct.constant=(t,e)=>new Ht(t,e);const Qt=t=>({decode:t.decode.bind(t),encode:t.encode.bind(t)});var te={};Object.defineProperty(te,"__esModule",{value:!0}),te.s16=te.s8=te.nu64be=te.u48be=te.u40be=te.u32be=te.u24be=te.u16be=te.nu64=te.u48=te.u40=te.u32=te.u24=te.u16=Fe=te.u8=te.offset=te.greedy=te.Constant=te.UTF8=te.CString=te.Blob=te.Boolean=te.BitField=te.BitStructure=te.VariantLayout=te.Union=te.UnionLayoutDiscriminator=te.UnionDiscriminator=te.Structure=te.Sequence=te.DoubleBE=te.Double=te.FloatBE=te.Float=te.NearInt64BE=te.NearInt64=te.NearUInt64BE=te.NearUInt64=te.IntBE=te.Int=te.UIntBE=te.UInt=te.OffsetLayout=te.GreedyCount=te.ExternalLayout=te.bindConstructorLayout=te.nameWithProperty=te.Layout=te.uint8ArrayToBuffer=te.checkUint8Array=void 0,te.constant=te.utf8=te.cstr=Ne=te.blob=te.unionLayoutDiscriminator=te.union=te.seq=te.bits=te.struct=te.f64be=te.f64=te.f32be=te.f32=te.ns64be=te.s48be=te.s40be=te.s32be=te.s24be=te.s16be=te.ns64=te.s48=te.s40=te.s32=te.s24=void 0;const ee=f;function ne(t){if(!(t instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}function re(t){return ne(t),ee.Buffer.from(t.buffer,t.byteOffset,t.length)}te.checkUint8Array=ne,te.uint8ArrayToBuffer=re;class oe{constructor(t,e){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=e}makeDestinationObject(){return{}}getSpan(t,e){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const e=Object.create(this.constructor.prototype);return Object.assign(e,this),e.property=t,e}fromArray(t){}}function ie(t,e){return e.property?t+"["+e.property+"]":t}te.Layout=oe,te.nameWithProperty=ie,te.bindConstructorLayout=function(t,e){if("function"!=typeof t)throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(t,"layout_"))throw new Error("Class is already bound to a layout");if(!(e&&e instanceof oe))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(e,"boundConstructor_"))throw new Error("layout is already bound to a constructor");t.layout_=e,e.boundConstructor_=t,e.makeDestinationObject=()=>new t,Object.defineProperty(t.prototype,"encode",{value(t,n){return e.encode(this,t,n)},writable:!0}),Object.defineProperty(t,"decode",{value:(t,n)=>e.decode(t,n),writable:!0})};class se extends oe{isCount(){throw new Error("ExternalLayout is abstract")}}te.ExternalLayout=se;class ae extends se{constructor(t=1,e){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,e),this.elementSpan=t}isCount(){return!0}decode(t,e=0){ne(t);const n=t.length-e;return Math.floor(n/this.elementSpan)}encode(t,e,n){return 0}}te.GreedyCount=ae;class ue extends se{constructor(t,e=0,n){if(!(t instanceof oe))throw new TypeError("layout must be a Layout");if(!Number.isInteger(e))throw new TypeError("offset must be integer or undefined");super(t.span,n||t.property),this.layout=t,this.offset=e}isCount(){return this.layout instanceof ce||this.layout instanceof fe}decode(t,e=0){return this.layout.decode(t,e+this.offset)}encode(t,e,n=0){return this.layout.encode(t,e,n+this.offset)}}te.OffsetLayout=ue;class ce extends oe{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return re(t).readUIntLE(e,this.span)}encode(t,e,n=0){return re(e).writeUIntLE(t,n,this.span),this.span}}te.UInt=ce;class fe extends oe{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return re(t).readUIntBE(e,this.span)}encode(t,e,n=0){return re(e).writeUIntBE(t,n,this.span),this.span}}te.UIntBE=fe;class he extends oe{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return re(t).readIntLE(e,this.span)}encode(t,e,n=0){return re(e).writeIntLE(t,n,this.span),this.span}}te.Int=he;class de extends oe{constructor(t,e){if(super(t,e),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,e=0){return re(t).readIntBE(e,this.span)}encode(t,e,n=0){return re(e).writeIntBE(t,n,this.span),this.span}}te.IntBE=de;const le=Math.pow(2,32);function pe(t){const e=Math.floor(t/le);return{hi32:e,lo32:t-e*le}}function ye(t,e){return t*le+e}class ge extends oe{constructor(t){super(8,t)}decode(t,e=0){const n=re(t),r=n.readUInt32LE(e);return ye(n.readUInt32LE(e+4),r)}encode(t,e,n=0){const r=pe(t),o=re(e);return o.writeUInt32LE(r.lo32,n),o.writeUInt32LE(r.hi32,n+4),8}}te.NearUInt64=ge;class me extends oe{constructor(t){super(8,t)}decode(t,e=0){const n=re(t);return ye(n.readUInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=pe(t),o=re(e);return o.writeUInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}te.NearUInt64BE=me;class we extends oe{constructor(t){super(8,t)}decode(t,e=0){const n=re(t),r=n.readUInt32LE(e);return ye(n.readInt32LE(e+4),r)}encode(t,e,n=0){const r=pe(t),o=re(e);return o.writeUInt32LE(r.lo32,n),o.writeInt32LE(r.hi32,n+4),8}}te.NearInt64=we;class be extends oe{constructor(t){super(8,t)}decode(t,e=0){const n=re(t);return ye(n.readInt32BE(e),n.readUInt32BE(e+4))}encode(t,e,n=0){const r=pe(t),o=re(e);return o.writeInt32BE(r.hi32,n),o.writeUInt32BE(r.lo32,n+4),8}}te.NearInt64BE=be;class Ee extends oe{constructor(t){super(4,t)}decode(t,e=0){return re(t).readFloatLE(e)}encode(t,e,n=0){return re(e).writeFloatLE(t,n),4}}te.Float=Ee;class ke extends oe{constructor(t){super(4,t)}decode(t,e=0){return re(t).readFloatBE(e)}encode(t,e,n=0){return re(e).writeFloatBE(t,n),4}}te.FloatBE=ke;class Ie extends oe{constructor(t){super(8,t)}decode(t,e=0){return re(t).readDoubleLE(e)}encode(t,e,n=0){return re(e).writeDoubleLE(t,n),8}}te.Double=Ie;class ve extends oe{constructor(t){super(8,t)}decode(t,e=0){return re(t).readDoubleBE(e)}encode(t,e,n=0){return re(e).writeDoubleBE(t,n),8}}te.DoubleBE=ve;class Se extends oe{constructor(t,e,n){if(!(t instanceof oe))throw new TypeError("elementLayout must be a Layout");if(!(e instanceof se&&e.isCount()||Number.isInteger(e)&&0<=e))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let r=-1;!(e instanceof se)&&0<t.span&&(r=e*t.span),super(r,n),this.elementLayout=t,this.count=e}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0,r=this.count;if(r instanceof se&&(r=r.decode(t,e)),0<this.elementLayout.span)n=r*this.elementLayout.span;else{let o=0;for(;o<r;)n+=this.elementLayout.getSpan(t,e+n),++o}return n}decode(t,e=0){const n=[];let r=0,o=this.count;for(o instanceof se&&(o=o.decode(t,e));r<o;)n.push(this.elementLayout.decode(t,e)),e+=this.elementLayout.getSpan(t,e),r+=1;return n}encode(t,e,n=0){const r=this.elementLayout,o=t.reduce(((t,o)=>t+r.encode(o,e,n+t)),0);return this.count instanceof se&&this.count.encode(t.length,e,n),o}}te.Sequence=Se;class Ae extends oe{constructor(t,e,n){if(!Array.isArray(t)||!t.reduce(((t,e)=>t&&e instanceof oe),!0))throw new TypeError("fields must be array of Layout instances");"boolean"==typeof e&&void 0===n&&(n=e,e=void 0);for(const e of t)if(0>e.span&&void 0===e.property)throw new Error("fields cannot contain unnamed variable-length layout");let r=-1;try{r=t.reduce(((t,e)=>t+e.getSpan()),0)}catch(t){}super(r,e),this.fields=t,this.decodePrefixes=!!n}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;try{n=this.fields.reduce(((n,r)=>{const o=r.getSpan(t,e);return e+=o,n+o}),0)}catch(t){throw new RangeError("indeterminate span")}return n}decode(t,e=0){ne(t);const n=this.makeDestinationObject();for(const r of this.fields)if(void 0!==r.property&&(n[r.property]=r.decode(t,e)),e+=r.getSpan(t,e),this.decodePrefixes&&t.length===e)break;return n}encode(t,e,n=0){const r=n;let o=0,i=0;for(const r of this.fields){let s=r.span;if(i=0<s?s:0,void 0!==r.property){const o=t[r.property];void 0!==o&&(i=r.encode(o,e,n),0>s&&(s=r.getSpan(e,n)))}o=n,n+=s}return o+i-r}fromArray(t){const e=this.makeDestinationObject();for(const n of this.fields)void 0!==n.property&&0<t.length&&(e[n.property]=t.shift());return e}layoutFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}offsetOf(t){if("string"!=typeof t)throw new TypeError("property must be string");let e=0;for(const n of this.fields){if(n.property===t)return e;0>n.span?e=-1:0<=e&&(e+=n.span)}}}te.Structure=Ae;class Be{constructor(t){this.property=t}decode(t,e){throw new Error("UnionDiscriminator is abstract")}encode(t,e,n){throw new Error("UnionDiscriminator is abstract")}}te.UnionDiscriminator=Be;class xe extends Be{constructor(t,e){if(!(t instanceof se&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(e||t.property||"variant"),this.layout=t}decode(t,e){return this.layout.decode(t,e)}encode(t,e,n){return this.layout.encode(t,e,n)}}te.UnionLayoutDiscriminator=xe;class Te extends oe{constructor(t,e,n){let r;if(t instanceof ce||t instanceof fe)r=new xe(new ue(t));else if(t instanceof se&&t.isCount())r=new xe(t);else{if(!(t instanceof Be))throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");r=t}if(void 0===e&&(e=null),!(null===e||e instanceof oe))throw new TypeError("defaultLayout must be null or a Layout");if(null!==e){if(0>e.span)throw new Error("defaultLayout must have constant span");void 0===e.property&&(e=e.replicate("content"))}let o=-1;e&&(o=e.span,0<=o&&(t instanceof ce||t instanceof fe)&&(o+=r.layout.span)),super(o,n),this.discriminator=r,this.usesPrefixDiscriminator=t instanceof ce||t instanceof fe,this.defaultLayout=e,this.registry={};let i=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(t){return i(t)},this.configGetSourceVariant=function(t){i=t.bind(this)}}getSpan(t,e=0){if(0<=this.span)return this.span;const n=this.getVariant(t,e);if(!n)throw new Error("unable to determine span for unrecognized variant");return n.getSpan(t,e)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const e=this.registry[t[this.discriminator.property]];if(e&&(!e.layout||e.property&&Object.prototype.hasOwnProperty.call(t,e.property)))return e}else for(const e in this.registry){const n=this.registry[e];if(n.property&&Object.prototype.hasOwnProperty.call(t,n.property))return n}throw new Error("unable to infer src variant")}decode(t,e=0){let n;const r=this.discriminator,o=r.decode(t,e),i=this.registry[o];if(void 0===i){const i=this.defaultLayout;let s=0;this.usesPrefixDiscriminator&&(s=r.layout.span),n=this.makeDestinationObject(),n[r.property]=o,n[i.property]=i.decode(t,e+s)}else n=i.decode(t,e);return n}encode(t,e,n=0){const r=this.getSourceVariant(t);if(void 0===r){const r=this.discriminator,o=this.defaultLayout;let i=0;return this.usesPrefixDiscriminator&&(i=r.layout.span),r.encode(t[r.property],e,n),i+o.encode(t[o.property],e,n+i)}return r.encode(t,e,n)}addVariant(t,e,n){const r=new Le(this,t,e,n);return this.registry[t]=r,r}getVariant(t,e=0){let n;return n=t instanceof Uint8Array?this.discriminator.decode(t,e):t,this.registry[n]}}te.Union=Te;class Le extends oe{constructor(t,e,n,r){if(!(t instanceof Te))throw new TypeError("union must be a Union");if(!Number.isInteger(e)||0>e)throw new TypeError("variant must be a (non-negative) integer");if("string"==typeof n&&void 0===r&&(r=n,n=null),n){if(!(n instanceof oe))throw new TypeError("layout must be a Layout");if(null!==t.defaultLayout&&0<=n.span&&n.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if("string"!=typeof r)throw new TypeError("variant must have a String property")}let o=t.span;0>t.span&&(o=n?n.span:0,0<=o&&t.usesPrefixDiscriminator&&(o+=t.discriminator.layout.span)),super(o,r),this.union=t,this.variant=e,this.layout=n||null}getSpan(t,e=0){if(0<=this.span)return this.span;let n=0;this.union.usesPrefixDiscriminator&&(n=this.union.discriminator.layout.span);let r=0;return this.layout&&(r=this.layout.getSpan(t,e+n)),n+r}decode(t,e=0){const n=this.makeDestinationObject();if(this!==this.union.getVariant(t,e))throw new Error("variant mismatch");let r=0;return this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout?n[this.property]=this.layout.decode(t,e+r):this.property?n[this.property]=!0:this.union.usesPrefixDiscriminator&&(n[this.union.discriminator.property]=this.variant),n}encode(t,e,n=0){let r=0;if(this.union.usesPrefixDiscriminator&&(r=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,e,n);let o=r;if(this.layout&&(this.layout.encode(t[this.property],e,n+r),o+=this.layout.getSpan(e,n+r),0<=this.union.span&&o>this.union.span))throw new Error("encoded variant overruns containing union");return o}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}function Ue(t){return 0>t&&(t+=4294967296),t}te.VariantLayout=Le;class Pe extends oe{constructor(t,e,n){if(!(t instanceof ce||t instanceof fe))throw new TypeError("word must be a UInt or UIntBE layout");if("string"==typeof e&&void 0===n&&(n=e,e=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,n),this.word=t,this.msb=!!e,this.fields=[];let r=0;this._packedSetValue=function(t){return r=Ue(t),this},this._packedGetValue=function(){return r}}decode(t,e=0){const n=this.makeDestinationObject(),r=this.word.decode(t,e);this._packedSetValue(r);for(const e of this.fields)void 0!==e.property&&(n[e.property]=e.decode(t));return n}encode(t,e,n=0){const r=this.word.decode(e,n);this._packedSetValue(r);for(const e of this.fields)if(void 0!==e.property){const n=t[e.property];void 0!==n&&e.encode(n)}return this.word.encode(this._packedGetValue(),e,n)}addField(t,e){const n=new Oe(this,t,e);return this.fields.push(n),n}addBoolean(t){const e=new Ce(this,t);return this.fields.push(e),e}fieldFor(t){if("string"!=typeof t)throw new TypeError("property must be string");for(const e of this.fields)if(e.property===t)return e}}te.BitStructure=Pe;class Oe{constructor(t,e,n){if(!(t instanceof Pe))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(e)||0>=e)throw new TypeError("bits must be positive integer");const r=8*t.span,o=t.fields.reduce(((t,e)=>t+e.bits),0);if(e+o>r)throw new Error("bits too long for span remainder ("+(r-o)+" of "+r+" remain)");this.container=t,this.bits=e,this.valueMask=(1<<e)-1,32===e&&(this.valueMask=4294967295),this.start=o,this.container.msb&&(this.start=r-o-e),this.wordMask=Ue(this.valueMask<<this.start),this.property=n}decode(t,e){return Ue(this.container._packedGetValue()&this.wordMask)>>>this.start}encode(t){if("number"!=typeof t||!Number.isInteger(t)||t!==Ue(t&this.valueMask))throw new TypeError(ie("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const e=this.container._packedGetValue(),n=Ue(t<<this.start);this.container._packedSetValue(Ue(e&~this.wordMask)|n)}}te.BitField=Oe;class Ce extends Oe{constructor(t,e){super(t,1,e)}decode(t,e){return!!super.decode(t,e)}encode(t){"boolean"==typeof t&&(t=+t),super.encode(t)}}te.Boolean=Ce;class Me extends oe{constructor(t,e){if(!(t instanceof se&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let n=-1;t instanceof se||(n=t),super(n,e),this.length=t}getSpan(t,e){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),n}decode(t,e=0){let n=this.span;return 0>n&&(n=this.length.decode(t,e)),re(t).slice(e,e+n)}encode(t,e,n){let r=this.length;if(this.length instanceof se&&(r=t.length),!(t instanceof Uint8Array&&r===t.length))throw new TypeError(ie("Blob.encode",this)+" requires (length "+r+") Uint8Array as src");if(n+r>e.length)throw new RangeError("encoding overruns Uint8Array");const o=re(t);return re(e).write(o.toString("hex"),n,r,"hex"),this.length instanceof se&&this.length.encode(r,e,n),r}}te.Blob=Me;class De extends oe{constructor(t){super(-1,t)}getSpan(t,e=0){ne(t);let n=e;for(;n<t.length&&0!==t[n];)n+=1;return 1+n-e}decode(t,e=0){const n=this.getSpan(t,e);return re(t).slice(e,e+n-1).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=ee.Buffer.from(t,"utf8"),o=r.length;if(n+o>e.length)throw new RangeError("encoding overruns Buffer");const i=re(e);return r.copy(i,n),i[n+o]=0,o+1}}te.CString=De;class Re extends oe{constructor(t,e){if("string"==typeof t&&void 0===e&&(e=t,t=void 0),void 0===t)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,e),this.maxSpan=t}getSpan(t,e=0){return ne(t),t.length-e}decode(t,e=0){const n=this.getSpan(t,e);if(0<=this.maxSpan&&this.maxSpan<n)throw new RangeError("text length exceeds maxSpan");return re(t).slice(e,e+n).toString("utf-8")}encode(t,e,n=0){"string"!=typeof t&&(t=String(t));const r=ee.Buffer.from(t,"utf8"),o=r.length;if(0<=this.maxSpan&&this.maxSpan<o)throw new RangeError("text length exceeds maxSpan");if(n+o>e.length)throw new RangeError("encoding overruns Buffer");return r.copy(re(e),n),o}}te.UTF8=Re;class ze extends oe{constructor(t,e){super(0,e),this.value=t}decode(t,e){return this.value}encode(t,e,n){return 0}}te.Constant=ze,te.greedy=(t,e)=>new ae(t,e),te.offset=(t,e,n)=>new ue(t,e,n);var Fe=te.u8=t=>new ce(1,t);te.u16=t=>new ce(2,t),te.u24=t=>new ce(3,t),te.u32=t=>new ce(4,t),te.u40=t=>new ce(5,t),te.u48=t=>new ce(6,t),te.nu64=t=>new ge(t),te.u16be=t=>new fe(2,t),te.u24be=t=>new fe(3,t),te.u32be=t=>new fe(4,t),te.u40be=t=>new fe(5,t),te.u48be=t=>new fe(6,t),te.nu64be=t=>new me(t),te.s8=t=>new he(1,t),te.s16=t=>new he(2,t),te.s24=t=>new he(3,t),te.s32=t=>new he(4,t),te.s40=t=>new he(5,t),te.s48=t=>new he(6,t),te.ns64=t=>new we(t),te.s16be=t=>new de(2,t),te.s24be=t=>new de(3,t),te.s32be=t=>new de(4,t),te.s40be=t=>new de(5,t),te.s48be=t=>new de(6,t),te.ns64be=t=>new be(t),te.f32=t=>new Ee(t),te.f32be=t=>new ke(t),te.f64=t=>new Ie(t),te.f64be=t=>new ve(t),te.struct=(t,e,n)=>new Ae(t,e,n),te.bits=(t,e,n)=>new Pe(t,e,n),te.seq=(t,e,n)=>new Se(t,e,n),te.union=(t,e,n)=>new Te(t,e,n),te.unionLayoutDiscriminator=(t,e)=>new xe(t,e);var Ne=te.blob=(t,e)=>new Me(t,e);te.cstr=t=>new De(t),te.utf8=(t,e)=>new Re(t,e),te.constant=(t,e)=>new ze(t,e);var _e={};Object.defineProperty(_e,"__esModule",{value:!0});var je=_e.toBigIntLE=function(t){{const e=Buffer.from(t);e.reverse();const n=e.toString("hex");return 0===n.length?BigInt(0):BigInt(`0x${n}`)}};_e.toBigIntBE=function(t){{const e=t.toString("hex");return 0===e.length?BigInt(0):BigInt(`0x${e}`)}};var We=_e.toBufferLE=function(t,e){{const n=t.toString(16),r=Buffer.from(n.padStart(2*e,"0").slice(0,2*e),"hex");return r.reverse(),r}};_e.toBufferBE=function(t,e){{const n=t.toString(16);return Buffer.from(n.padStart(2*e,"0").slice(0,2*e),"hex")}};const Ve=($e=8,t=>{const e=Ne($e,t),{encode:n,decode:r}=Qt(e),o=e;return o.decode=(t,e)=>{const n=r(t,e);return je(Buffer.from(n))},o.encode=(t,e,r)=>{const o=We(t,$e);return n(o,e,r)},o});var $e;const Ge=t=>{const e=Fe(t),{encode:n,decode:r}=Qt(e),o=e;return o.decode=(t,e)=>!!r(t,e),o.encode=(t,e,r)=>{const o=Number(t);return n(o,e,r)},o},qe=t=>{const e=Ne(32,t),{encode:n,decode:o}=Qt(e),i=e;return i.decode=(t,e)=>{const n=o(t,e);return new r(n)},i.encode=(t,e,r)=>{const o=t.toBuffer();return n(o,e,r)},i};class He extends Error{constructor(t){super(t)}}class Je extends He{constructor(){super(...arguments),this.name="TokenInvalidInstructionProgramError"}}class Ye extends He{constructor(){super(...arguments),this.name="TokenInvalidInstructionKeysError"}}class Ze extends He{constructor(){super(...arguments),this.name="TokenInvalidInstructionDataError"}}class Ke extends He{constructor(){super(...arguments),this.name="TokenInvalidInstructionTypeError"}}var Xe;!function(t){t[t.InitializeMint=0]="InitializeMint",t[t.InitializeAccount=1]="InitializeAccount",t[t.InitializeMultisig=2]="InitializeMultisig",t[t.Transfer=3]="Transfer",t[t.Approve=4]="Approve",t[t.Revoke=5]="Revoke",t[t.SetAuthority=6]="SetAuthority",t[t.MintTo=7]="MintTo",t[t.Burn=8]="Burn",t[t.CloseAccount=9]="CloseAccount",t[t.FreezeAccount=10]="FreezeAccount",t[t.ThawAccount=11]="ThawAccount",t[t.TransferChecked=12]="TransferChecked",t[t.ApproveChecked=13]="ApproveChecked",t[t.MintToChecked=14]="MintToChecked",t[t.BurnChecked=15]="BurnChecked",t[t.InitializeAccount2=16]="InitializeAccount2",t[t.SyncNative=17]="SyncNative",t[t.InitializeAccount3=18]="InitializeAccount3",t[t.InitializeMultisig2=19]="InitializeMultisig2",t[t.InitializeMint2=20]="InitializeMint2",t[t.GetAccountDataSize=21]="GetAccountDataSize",t[t.InitializeImmutableOwner=22]="InitializeImmutableOwner",t[t.AmountToUiAmount=23]="AmountToUiAmount",t[t.UiAmountToAmount=24]="UiAmountToAmount",t[t.InitializeMintCloseAuthority=25]="InitializeMintCloseAuthority",t[t.TransferFeeExtension=26]="TransferFeeExtension",t[t.ConfidentialTransferExtension=27]="ConfidentialTransferExtension",t[t.DefaultAccountStateExtension=28]="DefaultAccountStateExtension",t[t.Reallocate=29]="Reallocate",t[t.MemoTransferExtension=30]="MemoTransferExtension",t[t.CreateNativeMint=31]="CreateNativeMint",t[t.InitializeNonTransferableMint=32]="InitializeNonTransferableMint",t[t.InterestBearingMintExtension=33]="InterestBearingMintExtension",t[t.CpiGuardExtension=34]="CpiGuardExtension",t[t.InitializePermanentDelegate=35]="InitializePermanentDelegate"}(Xe||(Xe={})),Xt([Jt("instruction"),Ve("amount")]);const Qe=Xt([Jt("instruction"),Ve("amount")]);function tn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==Qe.span)throw new Ze;const{keys:{account:n,delegate:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,delegate:n,owner:r,multiSigners:o},data:Qe.decode(i)}}(t);if(s.instruction!==Xe.Approve)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{account:n,delegate:r,owner:o,multiSigners:i},data:s}}const en=Xt([Jt("instruction"),Ve("amount"),Jt("decimals")]);function nn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==en.span)throw new Ze;const{keys:{account:n,mint:r,delegate:o,owner:i,multiSigners:s},data:a}=function({programId:t,keys:[e,n,r,o,...i],data:s}){return{programId:t,keys:{account:e,mint:n,delegate:r,owner:o,multiSigners:i},data:en.decode(s)}}(t);if(a.instruction!==Xe.ApproveChecked)throw new Ke;if(!(n&&r&&o&&i))throw new Ye;return{programId:e,keys:{account:n,mint:r,delegate:o,owner:i,multiSigners:s},data:a}}const rn=Xt([Jt("instruction"),Ve("amount")]);function on(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==rn.span)throw new Ze;const{keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,owner:r,multiSigners:o},data:rn.decode(i)}}(t);if(s.instruction!==Xe.Burn)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}}const sn=Xt([Jt("instruction"),Ve("amount"),Jt("decimals")]);function an(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==sn.span)throw new Ze;const{keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,owner:r,multiSigners:o},data:sn.decode(i)}}(t);if(s.instruction!==Xe.BurnChecked)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{account:n,mint:r,owner:o,multiSigners:i},data:s}}const un=Xt([Jt("instruction")]);function cn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==un.span)throw new Ze;const{keys:{account:n,destination:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,destination:n,authority:r,multiSigners:o},data:un.decode(i)}}(t);if(s.instruction!==Xe.CloseAccount)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{account:n,destination:r,authority:o,multiSigners:i},data:s}}var fn;!function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Mint=1]="Mint",t[t.Account=2]="Account"}(fn||(fn={}));var hn;Xt([Jt("m"),Jt("n"),Ge("isInitialized"),qe("signer1"),qe("signer2"),qe("signer3"),qe("signer4"),qe("signer5"),qe("signer6"),qe("signer7"),qe("signer8"),qe("signer9"),qe("signer10"),qe("signer11")]).span,function(t){t[t.Uninitialized=0]="Uninitialized",t[t.Initialized=1]="Initialized",t[t.Frozen=2]="Frozen"}(hn||(hn={}));Xt([qe("mint"),qe("owner"),Ve("amount"),Zt("delegateOption"),qe("delegate"),Jt("state"),Zt("isNativeOption"),Ve("isNative"),Ve("delegatedAmount"),Zt("closeAuthorityOption"),qe("closeAuthority")]).span;var dn;Xt([Zt("mintAuthorityOption"),qe("mintAuthority"),Ve("supply"),Jt("decimals"),Ge("isInitialized"),Zt("freezeAuthorityOption"),qe("freezeAuthority")]).span,function(t){t[t.Enable=0]="Enable",t[t.Disable=1]="Disable"}(dn||(dn={})),Xt([Jt("instruction"),Jt("cpiGuardInstruction")]);var ln;Xt([Ge("lockCpi")]).span,function(t){t[t.Initialize=0]="Initialize",t[t.Update=1]="Update"}(ln||(ln={})),Xt([Jt("instruction"),Jt("defaultAccountStateInstruction"),Jt("accountState")]);Xt([Jt("state")]).span;Xt([]).span;var pn;Xt([qe("rateAuthority"),Kt("initializationTimestamp"),ft("preUpdateAverageRate"),Kt("lastUpdateTimestamp"),ft("currentRate")]).span,function(t){t[t.Enable=0]="Enable",t[t.Disable=1]="Disable"}(pn||(pn={})),Xt([Jt("instruction"),Jt("memoTransferInstruction")]);Xt([Ge("requireIncomingTransferMemos")]).span;Xt([qe("closeAuthority")]).span;const yn=Xt([]);yn.span,yn.span;var gn;function mn(t){return Xt([Ve("epoch"),Ve("maximumFee"),Yt("transferFeeBasisPoints")],t)}Xt([qe("delegate")]).span,function(t){t[t.InitializeTransferFeeConfig=0]="InitializeTransferFeeConfig",t[t.TransferCheckedWithFee=1]="TransferCheckedWithFee",t[t.WithdrawWithheldTokensFromMint=2]="WithdrawWithheldTokensFromMint",t[t.WithdrawWithheldTokensFromAccounts=3]="WithdrawWithheldTokensFromAccounts",t[t.HarvestWithheldTokensToMint=4]="HarvestWithheldTokensToMint",t[t.SetTransferFee=5]="SetTransferFee"}(gn||(gn={})),Xt([Jt("instruction"),Jt("transferFeeInstruction"),Jt("transferFeeConfigAuthorityOption"),qe("transferFeeConfigAuthority"),Jt("withdrawWithheldAuthorityOption"),qe("withdrawWithheldAuthority"),Yt("transferFeeBasisPoints"),Ve("maximumFee")]),Xt([Jt("instruction"),Jt("transferFeeInstruction"),Ve("amount"),Jt("decimals"),Ve("fee")]),Xt([Jt("instruction"),Jt("transferFeeInstruction")]),Xt([Jt("instruction"),Jt("transferFeeInstruction"),Jt("numTokenAccounts")]),Xt([Jt("instruction"),Jt("transferFeeInstruction")]);Xt([qe("transferFeeConfigAuthority"),qe("withdrawWithheldAuthority"),Ve("withheldAmount"),mn("olderTransferFee"),mn("newerTransferFee")]).span;var wn;Xt([Ve("withheldAmount")]).span,function(t){t[t.Uninitialized=0]="Uninitialized",t[t.TransferFeeConfig=1]="TransferFeeConfig",t[t.TransferFeeAmount=2]="TransferFeeAmount",t[t.MintCloseAuthority=3]="MintCloseAuthority",t[t.ConfidentialTransferMint=4]="ConfidentialTransferMint",t[t.ConfidentialTransferAccount=5]="ConfidentialTransferAccount",t[t.DefaultAccountState=6]="DefaultAccountState",t[t.ImmutableOwner=7]="ImmutableOwner",t[t.MemoTransfer=8]="MemoTransfer",t[t.NonTransferable=9]="NonTransferable",t[t.InterestBearingConfig=10]="InterestBearingConfig",t[t.CpiGuard=11]="CpiGuard",t[t.PermanentDelegate=12]="PermanentDelegate",t[t.NonTransferableAccount=13]="NonTransferableAccount"}(wn||(wn={}));const bn=Xt([Jt("instruction")]);function En(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==bn.span)throw new Ze;const{keys:{account:n,mint:r,owner:o,rent:i},data:s}=function({programId:t,keys:[e,n,r,o],data:i}){return{programId:t,keys:{account:e,mint:n,owner:r,rent:o},data:bn.decode(i)}}(t);if(s.instruction!==Xe.InitializeAccount)throw new Ke;if(!(n&&r&&o&&i))throw new Ye;return{programId:e,keys:{account:n,mint:r,owner:o,rent:i},data:s}}Xt([Jt("instruction"),Jt("decimals"),qe("mintAuthority"),Jt("freezeAuthorityOption"),qe("freezeAuthority")]);const kn=Xt([Jt("instruction"),Jt("m")]);function In(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==kn.span)throw new Ze;const{keys:{account:n,rent:r,signers:o},data:i}=function({programId:t,keys:[e,n,...r],data:o}){return{programId:t,keys:{account:e,rent:n,signers:r},data:kn.decode(o)}}(t);if(i.instruction!==Xe.InitializeMultisig)throw new Ke;if(!n||!r||!o.length)throw new Ye;return{programId:e,keys:{account:n,rent:r,signers:o},data:i}}Xt([Jt("instruction")]),Xt([Jt("instruction")]);const vn=Xt([Jt("instruction")]);function Sn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==vn.span)throw new Ze;const{keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,authority:r,multiSigners:o},data:vn.decode(i)}}(t);if(s.instruction!==Xe.FreezeAccount)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}}const An=Xt([Jt("instruction"),Ve("amount")]);function Bn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==An.span)throw new Ze;const{keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{mint:e,destination:n,authority:r,multiSigners:o},data:An.decode(i)}}(t);if(s.instruction!==Xe.MintTo)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}}const xn=Xt([Jt("instruction"),Ve("amount"),Jt("decimals")]);function Tn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==xn.span)throw new Ze;const{keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{mint:e,destination:n,authority:r,multiSigners:o},data:xn.decode(i)}}(t);if(s.instruction!==Xe.MintToChecked)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{mint:n,destination:r,authority:o,multiSigners:i},data:s}}const Ln=Xt([Jt("instruction")]);function Un(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==Ln.span)throw new Ze;const{keys:{account:n,owner:r,multiSigners:o},data:i}=function({programId:t,keys:[e,n,...r],data:o}){return{programId:t,keys:{account:e,owner:n,multiSigners:r},data:Ln.decode(o)}}(t);if(i.instruction!==Xe.Revoke)throw new Ke;if(!n||!r)throw new Ye;return{programId:e,keys:{account:n,owner:r,multiSigners:o},data:i}}var Pn;!function(t){t[t.MintTokens=0]="MintTokens",t[t.FreezeAccount=1]="FreezeAccount",t[t.AccountOwner=2]="AccountOwner",t[t.CloseAccount=3]="CloseAccount"}(Pn||(Pn={}));const On=Xt([Jt("instruction"),Jt("authorityType"),Jt("newAuthorityOption"),qe("newAuthority")]);function Cn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==On.span)throw new Ze;const{keys:{account:n,currentAuthority:r,multiSigners:o},data:i}=function({programId:t,keys:[e,n,...r],data:o}){const{instruction:i,authorityType:s,newAuthorityOption:a,newAuthority:u}=On.decode(o);return{programId:t,keys:{account:e,currentAuthority:n,multiSigners:r},data:{instruction:i,authorityType:s,newAuthority:a?u:null}}}(t);if(i.instruction!==Xe.SetAuthority)throw new Ke;if(!n||!r)throw new Ye;return{programId:e,keys:{account:n,currentAuthority:r,multiSigners:o},data:i}}const Mn=Xt([Jt("instruction")]);function Dn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==Mn.span)throw new Ze;const{keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{account:e,mint:n,authority:r,multiSigners:o},data:Mn.decode(i)}}(t);if(s.instruction!==Xe.ThawAccount)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{account:n,mint:r,authority:o,multiSigners:i},data:s}}const Rn=Xt([Jt("instruction"),Ve("amount")]);function zn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==Rn.span)throw new Ze;const{keys:{source:n,destination:r,owner:o,multiSigners:i},data:s}=function({programId:t,keys:[e,n,r,...o],data:i}){return{programId:t,keys:{source:e,destination:n,owner:r,multiSigners:o},data:Rn.decode(i)}}(t);if(s.instruction!==Xe.Transfer)throw new Ke;if(!n||!r||!o)throw new Ye;return{programId:e,keys:{source:n,destination:r,owner:o,multiSigners:i},data:s}}const Fn=Xt([Jt("instruction"),Ve("amount"),Jt("decimals")]);function Nn(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==Fn.span)throw new Ze;const{keys:{source:n,mint:r,destination:o,owner:i,multiSigners:s},data:a}=function({programId:t,keys:[e,n,r,o,...i],data:s}){return{programId:t,keys:{source:e,mint:n,destination:r,owner:o,multiSigners:i},data:Fn.decode(s)}}(t);if(a.instruction!==Xe.TransferChecked)throw new Ke;if(!(n&&r&&o&&i))throw new Ye;return{programId:e,keys:{source:n,mint:r,destination:o,owner:i,multiSigners:s},data:a}}const _n=Xt([Jt("instruction"),Jt("decimals"),qe("mintAuthority"),Jt("freezeAuthorityOption"),qe("freezeAuthority")]);function jn({programId:t,keys:[e,n],data:r}){const{instruction:o,decimals:i,mintAuthority:s,freezeAuthorityOption:a,freezeAuthority:u}=_n.decode(r);return{programId:t,keys:{mint:e,rent:n},data:{instruction:o,decimals:i,mintAuthority:s,freezeAuthority:a?u:null}}}var Wn;function Vn(t){const e=t.startsWith("0x")?t.slice(2):t;return Buffer.from(e)}function $n(t,e=void 0){const n="legacy"===t.version?t.accountKeys:t.staticAccountKeys,o=t.header.numReadonlySignedAccounts,i=t.header.numReadonlyUnsignedAccounts,s=t.header.numRequiredSignatures,a=n.length;let u=n.map(((t,e)=>({isSigner:e<s,isWritable:e<s-o||e>=s&&e<a-i,pubkey:new r(t)})));const[c,f]="legacy"===t.version?[[],[]]:e?[e.writable,e.readonly]:[[],[]];return c&&(u=[...u,...c.map((t=>({isSigner:!1,isWritable:!0,pubkey:t})))]),f&&(u=[...u,...f.map((t=>({isSigner:!1,isWritable:!1,pubkey:t})))]),u}function Gn(e,n){if("string"==typeof e.data){const r=e;return new o({data:t.bytes.bs58.decode(r.data),programId:n[r.programIdIndex].pubkey,keys:r.accounts.map((t=>n[t]))})}{const t=e;return new o({data:Buffer.from(t.data),programId:n[t.programIdIndex].pubkey,keys:t.accountKeyIndexes.map((t=>{if(t>=n.length)throw new Error(`Trying to resolve account at index ${t} while parsedAccounts is only ${n.length}. \t\t\t\t\t\tLooks like you're trying to parse versioned transaction, make sure that LoadedAddresses are passed to the \t\t\t\t\t\tparseTransactionAccounts function`);return n[t]}))})}}function qn(t,e){const n=e.map((t=>({pk:t.pubkey.toString(),...t})));return t.map((t=>{const e=t.toString(),r=n.find((t=>t.pk===e));if(!r)throw new Error(`Account ${e} not present in account meta!`);return r}))}function Hn(e,n){return new o({data:t.bytes.bs58.decode(e.data),programId:e.programId,keys:qn(e.accounts,n)})}function Jn(t){var e,n,r;const o=[];if(null==t)return[];const i=t.transaction.message.compiledInstructions,s=$n(t.transaction.message,null===(e=t.meta)||void 0===e?void 0:e.loadedAddresses),a=((null===(n=null==t?void 0:t.meta)||void 0===n?void 0:n.innerInstructions)||[]).sort(((t,e)=>t.index-e.index)),u=((null===(r=t.meta)||void 0===r?void 0:r.innerInstructions)||[]).reduce(((t,e)=>t+e.instructions.length),0)+i.length;let c=-1,f=-1;for(const t of a){for(;c!==t.index;)c+=1,f+=1,o.push(Gn(i[c],s));for(const e of t.instructions)o.push(Gn(e,s)),f+=1}for(;f<u-1;)c+=1,f+=1,o.push(Gn(i[c],s));return o}function Yn(t,e,n,r){return{logMessages:[],dataLogs:[],rawLogs:[],errors:[],programId:t,depth:e,id:n,instructionIndex:r}}function Zn(t){const e=/(?<logTruncated>^Log truncated$)|(?<programInvoke>^Program (?<invokeProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) invoke \[(?<level>\d+)\]$)|(?<programSuccessResult>^Program (?<successResultProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) success$)|(?<programFailedResult>^Program (?<failedResultProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) failed: (?<failedResultErr>.*)$)|(?<programCompleteFailedResult>^Program failed to complete: (?<failedCompleteError>.*)$)|(?<programLog>^^Program log: (?<logMessage>.*)$)|(?<programData>^Program data: (?<data>.*)$)|(?<programConsumed>^Program (?<consumedProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) consumed (?<consumedComputeUnits>\d*) of (?<allComputedUnits>\d*) compute units$)|(?<programReturn>^Program return: (?<returnProgramId>[1-9A-HJ-NP-Za-km-z]{32,}) (?<returnMessage>.*)$)/s,n=[];let r=-1,o=0,i=0;const s=[],a=[];for(const u of t){const t=e.exec(u);if(!t||!t.groups)throw new Error(`Failed to parse log line: ${u}`);if(t.groups.logTruncated)n[a[a.length-1]].invokeResult="Log truncated";else if(t.groups.programInvoke){if(s.push(t.groups.invokeProgramId),r+=1,i+=1,a.push(r),t.groups.level!=i.toString())throw new Error(`invoke depth mismatch, log: ${t.groups.level}, expected: ${i}`);n.push(Yn(s[s.length-1],s.length,r,o)),n[n.length-1].rawLogs.push(u)}else if(t.groups.programSuccessResult){const e=s.pop(),r=a.pop();if(void 0===r)throw new Error("callIds malformed");if(e!=t.groups.successResultProgramId)throw new Error("[ProramSuccess] callstack mismatch");n[r].rawLogs.push(u),i-=1,0===i&&(o+=1)}else if(t.groups.programFailedResult){if(s.pop()!=t.groups.failedResultProgramId)throw new Error("[ProgramFailed] callstack mismatch");n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].errors.push(t.groups.failedResultErr)}else if(t.groups.programCompleteFailedResult)n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].errors.push(t.groups.failedCompleteError);else if(t.groups.programLog)n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].logMessages.push(t.groups.logMessage);else if(t.groups.programData)n[a[a.length-1]].rawLogs.push(u),n[a[a.length-1]].dataLogs.push(t.groups.data);else if(t.groups.programConsumed)n[a[a.length-1]].rawLogs.push(u);else if(t.groups.programReturn){if(s[s.length-1]!=t.groups.returnProgramId)throw new Error("[InvokeReturn]: callstack mismatch");n[a[a.length-1]].invokeResult=t.groups.returnMessage}}return n}function Kn(t){let n;switch(c.decodeInstructionType(t)){case"AdvanceNonceAccount":{const e=c.decodeNonceAdvance(t);n={name:"advanceNonceAccount",accounts:[{name:"nonce",pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{name:"recentBlockhashSysvar",...t.keys[1]},{name:"nonceAuthority",pubkey:e.authorizedPubkey,isSigner:!0,isWritable:!1}],args:{}};break}case"Allocate":{const r=c.decodeAllocate(t);n={name:"allocate",accounts:[{name:"newAccount",pubkey:r.accountPubkey,isSigner:!0,isWritable:!0}],args:{space:new e(r.space)}};break}case"AllocateWithSeed":{const r=c.decodeAllocateWithSeed(t);n={name:"allocateWithSeed",accounts:[{name:"newAccount",pubkey:r.accountPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:r.basePubkey,isSigner:!0,isWritable:!1}],args:{seed:r.seed,space:new e(r.space),owner:r.programId,base:r.basePubkey}};break}case"Assign":{const e=c.decodeAssign(t);n={name:"assign",accounts:[{name:"assignedAccount",pubkey:e.accountPubkey,isSigner:!0,isWritable:!0}],args:{owner:e.programId}};break}case"AssignWithSeed":{const e=c.decodeAssignWithSeed(t);n={name:"assignWithSeed",accounts:[{name:"assigned",pubkey:e.accountPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:e.basePubkey,isSigner:!0,isWritable:!1}],args:{seed:e.seed,owner:e.programId,base:e.basePubkey}};break}case"AuthorizeNonceAccount":{const e=c.decodeNonceAuthorize(t);n={name:"authorizeNonceAccount",accounts:[{name:"nonce",isSigner:!1,isWritable:!0,pubkey:e.noncePubkey},{name:"nonceAuthority",isSigner:!0,isWritable:!1,pubkey:e.authorizedPubkey}],args:{authorized:e.newAuthorizedPubkey}};break}case"Create":{const r=c.decodeCreateAccount(t);n={name:"createAccount",accounts:[{name:"payer",pubkey:r.fromPubkey,isSigner:!0,isWritable:!0},{name:"newAccount",pubkey:r.newAccountPubkey,isSigner:!0,isWritable:!0}],args:{lamports:new e(r.lamports),owner:r.programId,space:new e(r.space)}};break}case"CreateWithSeed":{const r=c.decodeCreateWithSeed(t);n={name:"createAccountWithSeed",accounts:[{name:"payer",pubkey:r.fromPubkey,isSigner:!0,isWritable:!0},{name:"created",pubkey:r.newAccountPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:r.basePubkey,isSigner:!0,isWritable:!1}],args:{lamports:new e(r.lamports),owner:r.programId,space:new e(r.space),seed:r.seed,base:r.basePubkey}};break}case"InitializeNonceAccount":{const e=c.decodeNonceInitialize(t);n={name:"initializeNonceAccount",accounts:[{name:"nonce",pubkey:e.noncePubkey,isSigner:!1,isWritable:!0},{name:"recentBlockhashSysvar",...t.keys[1]},{name:"rentSysvar",...t.keys[2]}],args:{authorized:e.authorizedPubkey}};break}case"Transfer":{const r=c.decodeTransfer(t);n={name:"transfer",accounts:[{name:"sender",pubkey:r.fromPubkey,isSigner:!0,isWritable:!0},{name:"receiver",pubkey:r.toPubkey,isWritable:!0,isSigner:!1}],args:{lamports:new e(r.lamports.toString())}};break}case"TransferWithSeed":{const r=c.decodeTransferWithSeed(t);n={name:"transferWithSeed",accounts:[{name:"sender",pubkey:r.fromPubkey,isSigner:!1,isWritable:!0},{name:"base",pubkey:r.basePubkey,isSigner:!0,isWritable:!1},{name:"receiver",pubkey:r.toPubkey,isSigner:!1,isWritable:!0}],args:{owner:r.programId,lamports:new e(r.lamports.toString()),seed:r.seed}};break}case"WithdrawNonceAccount":{const r=c.decodeNonceWithdraw(t);n={name:"withdrawNonceAccount",accounts:[{name:"nonce",pubkey:r.noncePubkey,isSigner:!1,isWritable:!0},{name:"recepient",pubkey:r.toPubkey,isSigner:!1,isWritable:!0},{name:"recentBlockhashSysvar",...t.keys[2]},{name:"rentSysvar",...t.keys[3]},{name:"nonceAuthority",pubkey:r.noncePubkey,isSigner:!0,isWritable:!1}],args:{lamports:new e(r.lamports)}};break}default:n=null}return n?{...n,programId:i.programId}:{programId:i.programId,name:"unknown",accounts:t.keys,args:{unknown:t.data}}}function Xn(t){let n;switch(ot().decode(t.data)){case Xe.InitializeMint:{const e=function(t,e=at){if(!t.programId.equals(e))throw new Je;if(t.data.length!==_n.span)throw new Ze;const{keys:{mint:n,rent:r},data:o}=jn(t);if(o.instruction!==Xe.InitializeMint)throw new Ke;if(!n||!r)throw new Ye;return{programId:e,keys:{mint:n,rent:r},data:o}}(t);n={name:"initializeMint",accounts:[{name:"tokenMint",...e.keys.mint},{name:"rentSysvar",...e.keys.rent}],args:{decimals:e.data.decimals,mintAuthority:e.data.mintAuthority,freezeAuthority:e.data.freezeAuthority}};break}case Xe.InitializeAccount:{const e=En(t);n={name:"initializeAccount",accounts:[{name:"newAccount",...e.keys.account},{name:"tokenMint",...e.keys.mint},{name:"owner",...e.keys.owner},{name:"rentSysvar",...e.keys.rent}],args:{}};break}case Xe.InitializeMultisig:{const e=In(t),r=e.keys.signers.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"initializeMultisig",accounts:[{name:"multisig",...e.keys.account},{name:"rentSysvar",...e.keys.rent},...r],args:{m:e.data.m}};break}case Xe.Transfer:{const r=zn(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"transfer",accounts:[{name:"source",...r.keys.source},{name:"destination",...r.keys.destination},{name:"owner",...r.keys.owner},...o],args:{amount:new e(r.data.amount.toString())}};break}case Xe.Approve:{const r=tn(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"approve",accounts:[{name:"source",...r.keys.account},{name:"delegate",...r.keys.delegate},{name:"owner",...r.keys.owner},...o],args:{amount:new e(r.data.amount.toString())}};break}case Xe.Revoke:{const e=Un(t),r=e.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"revoke",accounts:[{name:"source",...e.keys.account},{name:"owner",...e.keys.owner},...r],args:{}};break}case Xe.SetAuthority:{const e=Cn(t),r={[Pn.AccountOwner]:{accountOwner:{}},[Pn.CloseAccount]:{closeAccount:{}},[Pn.FreezeAccount]:{freezeAccount:{}},[Pn.MintTokens]:{mintTokens:{}}},o=e.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"setAuthority",accounts:[{name:"account",...e.keys.account},{name:"currentAuthority",...e.keys.currentAuthority},...o],args:{authorityType:r[e.data.authorityType],newAuthority:e.data.newAuthority}};break}case Xe.MintTo:{const r=Bn(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"mintTo",accounts:[{name:"tokenMint",...r.keys.mint},{name:"mintTo",...r.keys.destination},{name:"authority",...r.keys.authority},...o],args:{amount:new e(r.data.amount.toString())}};break}case Xe.Burn:{const r=on(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"burn",accounts:[{name:"burnFrom",...r.keys.account},{name:"tokenMint",...r.keys.mint},{name:"owner",...r.keys.owner},...o],args:{amount:new e(r.data.amount.toString())}};break}case Xe.CloseAccount:{const e=cn(t),r=e.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"closeAccount",accounts:[{name:"account",...e.keys.account},{name:"destination",...e.keys.destination},{name:"owner",...e.keys.authority},...r],args:{}};break}case Xe.FreezeAccount:{const e=Sn(t),r=e.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"freezeAccount",accounts:[{name:"account",...e.keys.account},{name:"tokenMint",...e.keys.mint},{name:"authority",...e.keys.authority},...r],args:{}};break}case Xe.ThawAccount:{const e=Dn(t),r=e.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"thawAccount",accounts:[{name:"account",...e.keys.account},{name:"tokenMint",...e.keys.mint},{name:"authority",...e.keys.authority},...r],args:{}};break}case Xe.TransferChecked:{const r=Nn(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"transferChecked",accounts:[{name:"source",...r.keys.source},{name:"tokenMint",...r.keys.mint},{name:"destination",...r.keys.destination},{name:"owner",...r.keys.owner},...o],args:{amount:new e(r.data.amount.toString()),decimals:r.data.decimals}};break}case Xe.ApproveChecked:{const r=nn(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"approveChecked",accounts:[{name:"source",...r.keys.account},{name:"tokenMint",...r.keys.mint},{name:"delegate",...r.keys.delegate},{name:"owner",...r.keys.owner},...o],args:{amount:new e(r.data.amount.toString()),decimals:r.data.decimals}};break}case Xe.MintToChecked:{const r=Tn(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"mintToChecked",accounts:[{name:"tokenMint",...r.keys.mint},{name:"mintTo",...r.keys.destination},{name:"authority",...r.keys.authority},...o],args:{amount:new e(r.data.amount.toString()),decimals:r.data.decimals}};break}case Xe.BurnChecked:{const r=an(t),o=r.keys.multiSigners.map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"burnChecked",accounts:[{name:"burnFrom",...r.keys.account},{name:"tokenMint",...r.keys.mint},{name:"owner",...r.keys.owner},...o],args:{amount:new e(r.data.amount.toString()),decimals:r.data.decimals}};break}case Xe.InitializeAccount2:{const e=it([ot("instruction"),st(32,"owner")]).decode(t.data);n={name:"initializeAccount2",accounts:[{name:"newAccount",...t.keys[0]},{name:"tokenMint",...t.keys[1]},{name:"rentSysvar",...t.keys[2]}],args:{owner:new r(e.owner)}};break}case Xe.SyncNative:n={name:"syncNative",accounts:[{name:"account",...t.keys[0]}],args:{}};break;case Xe.InitializeAccount3:{const e=it([ot("instruction"),st(32,"owner")]).decode(t.data);n={name:"initializeAccount3",accounts:[{name:"newAccount",...t.keys[0]},{name:"tokenMint",...t.keys[1]}],args:{owner:new r(e.owner)}};break}case Xe.InitializeMultisig2:{const e=t.keys.slice(1).map(((t,e)=>({name:`signer_${e}`,...t})));n={name:"initializeMultisig2",accounts:[{name:"multisig",...t.keys[0]},...e],args:{m:t.data[1]}};break}case Xe.InitializeMint2:{const e=jn(t);if(!e.keys.mint)throw new Error("Failed to parse InitializeMint2 instruction");n={name:"initializeMint2",accounts:[{name:"tokenMint",...e.keys.mint}],args:{decimals:e.data.decimals,mintAuthority:e.data.mintAuthority,freezeAuthority:e.data.freezeAuthority}};break}default:n=null}return n?{...n,programId:at}:{programId:at,name:"unknown",accounts:t.keys,args:{unknown:t.data}}}function Qn(t){return{name:"createAssociatedTokenAccount",accounts:[{name:"fundingAccount",...t.keys[0]},{name:"newAccount",...t.keys[1]},{name:"wallet",...t.keys[2]},{name:"tokenMint",...t.keys[3]},{name:"systemProgram",...t.keys[4]},{name:"tokenProgram",...t.keys[5]},t.keys.length>5?{name:"rentSysvar",...t.keys[6]}:void 0],args:{},programId:ut}}function tr(t,e){return t.map((t=>{const n=t.name;if(Object.prototype.hasOwnProperty.call(t,"accounts")){const r=e?`${e} > ${n}`:n;return tr(t.accounts,r)}return{...t,name:e?`${e} > ${n}`:n}})).flat()}!function(t){t[t.Initialize=0]="Initialize",t[t.UpdateRate=1]="UpdateRate"}(Wn||(Wn={})),Xt([Jt("instruction"),Jt("interestBearingMintInstruction"),qe("rateAuthority"),ft("rate")]),Xt([Jt("instruction"),Jt("interestBearingMintInstruction"),ft("rate")]),Xt([Jt("instruction"),qe("owner")]),Xt([Jt("instruction"),qe("owner")]),Xt([Jt("instruction")]),Xt([Jt("instruction"),Jt("closeAuthorityOption"),qe("closeAuthority")]),Xt([Jt("instruction")]),Xt([Jt("instruction"),qe("delegate")]);class er{constructor(t,e){const n=[[i.programId.toBase58(),Kn],[at.toBase58(),Xn],[ut.toBase58(),Qn]];let o;e=e||[];for(const n of t)e.push(this.buildIdlParser(new r(n.programId),n.idl));if(e){o=new Map(e);for(const t of n)o.has(t[0])||o.set(...t)}else o=new Map(n);this.instructionParsers=o}addParser(t,e){this.instructionParsers.set(t.toBase58(),e)}addParserFromIdl(t,e){this.instructionParsers.set(...this.buildIdlParser(new r(t),e))}buildIdlParser(t,e){return[t.toBase58(),(t=>{const r=new n(e).decode(t.data);if(r){const n=e.instructions.find((t=>t.name===r.name));if(!n)return this.buildUnknownParsedInstruction(t.programId,t.keys,t.data,r.name);const o=tr(n.accounts),i=t.keys.map(((t,e)=>e<o.length?{name:o[e].name,...t}:{name:"Remaining "+(e-o.length),...t}));return{name:r.name,accounts:i,programId:t.programId,args:r.data}}return this.buildUnknownParsedInstruction(t.programId,t.keys,t.data)}).bind(this)]}removeParser(t){this.instructionParsers.delete(t.toBase58())}buildUnknownParsedInstruction(t,e,n,r){return{programId:t,accounts:e,args:{unknown:n},name:r||"unknown"}}parseInstruction(t){if(this.instructionParsers.has(t.programId.toBase58())){return this.instructionParsers.get(t.programId.toBase58())(t)}return this.buildUnknownParsedInstruction(t.programId,t.keys,t.data)}parseTransactionData(t,e=void 0){const n=$n(t,e);return t.compiledInstructions.map((t=>this.parseInstruction(Gn(t,n))))}parseTransactionParsedData(t){const e=t.accountKeys.map((t=>({isSigner:t.signer,isWritable:t.writable,pubkey:t.pubkey})));return t.instructions.map((t=>this.parseInstruction(Hn(t,e))))}async parseTransaction(t,e,n=!1,r="confirmed"){var o;const i=await t.getTransaction(e,{commitment:r,maxSupportedTransactionVersion:0});if(!i)return null;if(n){return Jn(i).map((t=>this.parseInstruction(t)))}return this.parseTransactionData(i.transaction.message,null===(o=i.meta)||void 0===o?void 0:o.loadedAddresses)}parseTransactionDump(t){t instanceof f.Buffer||(t=f.Buffer.from(t,"base64"));let e;if("legacy"==s.deserializeMessageVersion(t)){e=a.from(t).compileMessage()}else{e=u.deserialize(t).message}return this.parseTransactionData(e)}}export{er as SolanaParser,Gn as compiledInstructionToInstruction,Jn as flattenTransactionResponse,Vn as hexToBuffer,Zn as parseLogs,$n as parseTransactionAccounts,Hn as parsedInstructionToInstruction};
//# sourceMappingURL=index.js.map
